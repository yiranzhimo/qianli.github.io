<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Qian&#39;s blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2023-06-30T03:12:39.122Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Qian Li</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Single-cell spatial immune landscapes of primary and metastatic brain tumours</title>
    <link href="http://example.com/2023/06/30/Single-cell-spatial-immune-landscapes-of-primary-and-metastatic-brain-tumours/"/>
    <id>http://example.com/2023/06/30/Single-cell-spatial-immune-landscapes-of-primary-and-metastatic-brain-tumours/</id>
    <published>2023-06-30T03:04:27.000Z</published>
    <updated>2023-06-30T03:12:39.122Z</updated>
    
    <content type="html"><![CDATA[<h1id="single-cell-spatial-immune-landscapes-of-primary-and-metastatic-brain-tumours">Single-cellspatial immune landscapes of primary and metastatic brain tumours</h1><h2 id="abstract">Abstract</h2><p>Single-cell technologies have enabled the characterization of thetumour microenvironment at unprecedented depth and have revealed vastcellular diversity among tumour cells and their niche. Anti-tumourimmunity relies on cell–cell relationships within the tumourmicroenvironment1,2, yet many single-cell studies lack spatial contextand rely on dissociated tissues3. Here we applied imaging mass cytometryto characterize the immunological landscape of 139 high-grade glioma and46 brain metastasis tumours from patients. Single-cell analysis of morethan 1.1 million cells across 389 high-dimensional histopathology imagesenabled the spatial resolution of immune lineages and activation states,revealing differences in immune landscapes between primary tumours andbrain metastases from diverse solid cancers. These analyses revealedcellular neighbourhoods associated with survival in patients withglioblastoma, which we leveraged to identify a unique population ofmyeloperoxidase (MPO)-positive macrophages associated with long-termsurvival. Our findings provide insight into the biology of primary andmetastatic brain tumours, reinforcing the value of integrating spatialresolution to single-cell datasets to dissect the microenvironmentalcontexture of cancer.</p><h2 id="results">Results</h2><h3 id="figure1">FIgure1</h3><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/20230630_figure1.webp" /></p><p>The d plot indicates cell types as a percentage of all cells withinthe TME according to clinical subgroups。</p><p>The e plot shows the cell-type distribution of cell populations as apercentage of all cells in the TME.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/20230630_figure2.webp" /></p><p>The b plot shows T cell frequencies as a percentage of total cellsacross clinical subgroups.</p><p>The c plot shows heatmap of pairwise interaction-avoiddancescores.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/20230630_figure3.png" /></p><p>To define their differences from neighborhood, which claims its microenvironment.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/20230630_figure4.png" /></p><p>MPO+ macrophages are enriched in LTS tumours and are associated withenhanced cytotoxic functions.</p><h2 id="reference">Reference</h2><ul><li>[1] <ahref="https://www.nature.com/articles/s41586-022-05680-3">Single-cellspatial immune landscapes of primary and metastatic braintumours</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1
id=&quot;single-cell-spatial-immune-landscapes-of-primary-and-metastatic-brain-tumours&quot;&gt;Single-cell
spatial immune landscapes of primary and </summary>
      
    
    
    
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
    <category term="cancer" scheme="http://example.com/tags/cancer/"/>
    
    <category term="research" scheme="http://example.com/tags/research/"/>
    
  </entry>
  
  <entry>
    <title>Methods and applications for single-cell and spatial multi-omics</title>
    <link href="http://example.com/2023/06/30/Methods-and-applications-for-single-cell-and-spatial-multi-omics/"/>
    <id>http://example.com/2023/06/30/Methods-and-applications-for-single-cell-and-spatial-multi-omics/</id>
    <published>2023-06-30T01:47:56.000Z</published>
    <updated>2023-06-30T01:51:45.175Z</updated>
    
    <content type="html"><![CDATA[<h1id="methods-and-applications-for-single-cell-and-spatial-multi-omics">Methodsand applications for single-cell and spatial multi-omics</h1><h2 id="abstract">Abstract</h2><p>“The joint analysis of the genome, epigenome, transcriptome, proteomeand/or metabolome from single cells is transforming our understanding ofcell biology in health and disease. In less than a decade, the field hasseen tremendous technological revolutions that enable crucial newinsights into the interplay between intracellular and intercellularmolecular mechanisms that govern development, physiology andpathogenesis. In this Review, we highlight advances in thefastdeveloping field of single-cell and spatial multi-omics technologies(also known as multimodal omics approaches), and the computationalstrategies needed to integrate information across these molecularlayers. We demonstrate their impact on fundamental cell biology andtranslational research, discuss current challenges and provide anoutlook to the future.”</p><h2 id="reference">Reference</h2><ul><li>[1] <ahref="https://www.nature.com/articles/s41576-023-00580-2">Methods andapplications for single-cell and spatial multi-omics</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1
id=&quot;methods-and-applications-for-single-cell-and-spatial-multi-omics&quot;&gt;Methods
and applications for single-cell and spatial multi-omics&lt;/</summary>
      
    
    
    
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
    <category term="review" scheme="http://example.com/tags/review/"/>
    
    <category term="method" scheme="http://example.com/tags/method/"/>
    
  </entry>
  
  <entry>
    <title>Spatial mapping reveals human adipocyte subpopulations with distinct sensitivities to insulin</title>
    <link href="http://example.com/2023/06/29/Spatial-mapping-reveals-human-adipocyte-subpopulations-with-distinct-sensitivities-to-insulin/"/>
    <id>http://example.com/2023/06/29/Spatial-mapping-reveals-human-adipocyte-subpopulations-with-distinct-sensitivities-to-insulin/</id>
    <published>2023-06-29T09:37:41.000Z</published>
    <updated>2023-06-30T01:48:55.848Z</updated>
    
    <content type="html"><![CDATA[<h1id="spatial-mapping-reveals-human-adipocyte-subpopulations-with-distinct-sensitivities-to-insulin">Spatialmapping reveals human adipocyte subpopulations with distinctsensitivities to insulin</h1><h2 id="abstract">Abstract</h2><p>“The contribution of cellular heterogeneity and architecture to whiteadipose tissue (WAT) function is poorly understood. Herein, we combinedspatially resolved transcriptional profiling with single-cell RNAsequencing and image analyses to map human WAT composition andstructure. This identified 18 cell classes with unique propensities toform spatially organized homo- and heterotypic clusters. Of these, threeconstituted mature adipocytes that were similar in size, but distinct intheir spatial arrangements and transcriptional profiles. Based on markergenes, we termed these AdipoLEP, AdipoPLIN, and AdipoSAA. We confirmed,in independent datasets, that their respective gene profiles associateddifferently with both adipocyte and whole-body insulin sensitivity.Corroborating our observations, insulin stimulation in vivo byhyperinsulinemic-euglycemic clamp showed that only AdipoPLIN displayed atranscriptional response to insulin. Altogether, by mining thismultimodal resource we identify that human WAT is composed of threeclasses of mature adipocytes, only one of which is insulin responsive.”(Bäckdahl 等, 2021, p. 1869)</p><h2 id="results">Results</h2><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Figure%20thumbnail%20gr1.jpg" /></p><p>Figure 1 shows the basic analysis of ST and scRNA data.</p><p>In the above figure, if the spot has 6 neighbors, its degree scoresis 6.</p><p>How to calculate homotypic score?</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Figure%20thumbnail%20gr2.jpg" /></p><p>In the above figure, if the spot has 6 neighbors, its degree scoresis 6.</p><p>How to calculate homotypic score?</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/20230629_fig1.png" /></p><p>For each network, the arverage degree was calculated as <spanclass="math inline">\(\bar{k}=2 L / N\)</span>，where L and N,respectively, corresponds to the total number of edges and nodes (spots)in the network.</p><p>But to evaluate the gap between real degree and expected degree andaccount for difference in network size, the authors choose the averagedegree was computed for random networks where the spots’ classificationshad been shuffled within each sample. This process was repeated 50 timesin order to obtain an ‘‘expected’’ average degree.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Figure%20thumbnail%20gr3.jpg" /></p><p>How to calculate Heterotypic score?</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/20230629_fig2.png" /></p><p>If two classes are distinct, the score would be small.</p><h2 id="reference">Reference</h2><p>[1] <ahref="https://www.cell.com/cell-metabolism/fulltext/S1550-4131(21)00363-6">Spatialmapping reveals human adipocyte subpopulations with distinctsensitivities to insulin</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1
id=&quot;spatial-mapping-reveals-human-adipocyte-subpopulations-with-distinct-sensitivities-to-insulin&quot;&gt;Spatial
mapping reveals human adipocy</summary>
      
    
    
    
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
    <category term="research" scheme="http://example.com/tags/research/"/>
    
    <category term="WAT" scheme="http://example.com/tags/WAT/"/>
    
  </entry>
  
  <entry>
    <title>SRTsim</title>
    <link href="http://example.com/2023/03/06/SRTsim/"/>
    <id>http://example.com/2023/03/06/SRTsim/</id>
    <published>2023-03-06T03:09:24.000Z</published>
    <updated>2023-03-30T04:59:00.947Z</updated>
    
    <content type="html"><![CDATA[<p>Today, I read a paper, "SRTsim: spatial pattern preservingsimulations for spatially resolved transcriptomics" used to producesimulated data in spatial transcriptomics.</p><p>This is the main work process</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/SRTsim_1.png" /></p><p>What impresses me most is the way to test the advantages of SRTsim.It calculated the rand index between real data and simulated datathrough various of clustering methods.</p><h1 id="reference">Reference</h1><ul><li>[1] <ahref="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-023-02879-z">SRTsim:spatial pattern preserving simulations for spatially resolvedtranscriptomics</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Today, I read a paper, &quot;SRTsim: spatial pattern preserving
simulations for spatially resolved transcriptomics&quot; used to produce
simulated </summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>Spatial profiling technologies illuminate the tumor microenvironment</title>
    <link href="http://example.com/2023/03/04/Spatial%20profiling%20technologies%20illuminate%20the%20tumor%20microenvironment/"/>
    <id>http://example.com/2023/03/04/Spatial%20profiling%20technologies%20illuminate%20the%20tumor%20microenvironment/</id>
    <published>2023-03-04T00:44:35.000Z</published>
    <updated>2023-06-29T09:47:33.761Z</updated>
    
    <content type="html"><![CDATA[<p>In this review, most interesting is the figure which depicts theadvantages of in Spatial transcriptome in cancer research.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Spatial%20profiling%20technologies%20illuminate%20the%20tumor%20microenvironment_fig4.png" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;In this review, most interesting is the figure which depicts the
advantages of in Spatial transcriptome in cancer research.&lt;/p&gt;
&lt;p&gt;&lt;img
s</summary>
      
    
    
    
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
    <category term="review" scheme="http://example.com/tags/review/"/>
    
    <category term="cancer" scheme="http://example.com/tags/cancer/"/>
    
  </entry>
  
  <entry>
    <title>What is cancer metabolism?</title>
    <link href="http://example.com/2023/03/03/What%20is%20cancer%20metabolism?/"/>
    <id>http://example.com/2023/03/03/What%20is%20cancer%20metabolism?/</id>
    <published>2023-03-03T00:47:35.000Z</published>
    <updated>2023-03-09T12:03:22.762Z</updated>
    
    <content type="html"><![CDATA[<p>What is cancer metabolism? This is something to think about.</p><p>And I have read the paper <em>What is cancer metabolism?</em></p><p>What I learned is mainly two parts.</p><p>First, For tumor cells, it chooses to produce lactate even if oxygenis abundant.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Figure1.%20Warburg%20and%20Pasteur%20eff" /></p><p>Second, Nutrient uptake is largely initiated by receptor tyrosinekinases (RTKs) which activate signaling cascades that promote themembrane localization of nutrient transporters and activity of enzymesthat metabolize—and therefore help capture—nutrients. Signaling pathwaysdownstream of PI3K, most notably RAS, can also direct bulk uptake ofmacromolecules via macropinocytosis. Nutrient uptake is also facilitatedby transcriptional induction of membrane transporters via oncogenictranscription factors hypoxia-inducible factor (HIF), which activatesgenes encoding plasma membrane glucose transporters (Glut), and MYC,which activates genes encoding amino acid transporters such as Asct2.Genes frequently mutated or activated in cancer are colored orange.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Figure2.%20Mechanisms%20of%20nutrient" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;What is cancer metabolism? This is something to think about.&lt;/p&gt;
&lt;p&gt;And I have read the paper &lt;em&gt;What is cancer metabolism?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    
    <category term="review" scheme="http://example.com/tags/review/"/>
    
    <category term="cancer" scheme="http://example.com/tags/cancer/"/>
    
    <category term="metabolism" scheme="http://example.com/tags/metabolism/"/>
    
  </entry>
  
  <entry>
    <title>SpaCST</title>
    <link href="http://example.com/2023/02/28/SpaCST/"/>
    <id>http://example.com/2023/02/28/SpaCST/</id>
    <published>2023-02-28T13:44:35.000Z</published>
    <updated>2023-03-09T12:18:46.491Z</updated>
    
    <content type="html"><![CDATA[<p>SpaCET is a toolbox mainly focused on cancer areas in spatialtranscriptomics.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/spacet_figure1.webp" /></p><p>First, SpaCET estimates malignant cell fractions based on a genepattern dictionary of copy number alterations (CNA) and malignanttranscriptome signatures across common tumor types.</p><p>Second, SpaCET deconvolves nonmalignant cell fractions and adjustscell densities under a unified linear model. Using scRNA-seq datasetsfrom diverse cancer types, we defined reference expression profiles ofimmune and stromal cells in a hierarchical lineage</p><p>Third, SpaCET infers intercellular interactions based on cellcolocalization and ligand–receptor co-expression analysis.</p><p>What interest me most is cell interaction analysis.</p><p>For a spot, an L–R network score is defined as the sum of expressionproducts between all L–R pairs, divided by the average random value from1000 randomized networks. P values were calculated with the empiricalnull distribution generated from network scores of randomizedL–Rinteractions.</p><p>Network Score <span class="math inline">\((\mathrm{NS})=\frac{\sum_iE_{L i} \times E_{R i}}{\left\langle\sum_i E_{L i} \times E_{Ri}\right\rangle}, P\)</span> value <spanclass="math inline">\(=P_r\left(\mathrm{NS}_{\text {random }} \geq\mathrm{NS}\right)\)</span></p><p><span class="math inline">\(E_{Li}\)</span> and <spanclass="math inline">\(E_{Ri}\)</span> donate the expression of ligandand receptor from the ith L–R pair, respectively. The <spanclass="math inline">\(&lt;&gt;\)</span> represents averaging the productsums from 1000 random networks.</p><h1 id="reference">Reference</h1><ul><li>[1] <ahref="https://www.nature.com/articles/s41467-023-36062-6#Sec11">Estimationof cell lineages in tumors from spatial transcriptomics data</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;SpaCET is a toolbox mainly focused on cancer areas in spatial
transcriptomics.&lt;/p&gt;
&lt;p&gt;&lt;img
src=&quot;https://raw.githubusercontent.com/yiranzh</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
    <category term="cancer" scheme="http://example.com/tags/cancer/"/>
    
  </entry>
  
  <entry>
    <title>PDAC</title>
    <link href="http://example.com/2023/02/15/PDAC/"/>
    <id>http://example.com/2023/02/15/PDAC/</id>
    <published>2023-02-15T00:47:35.000Z</published>
    <updated>2023-03-09T12:12:53.803Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I read a new paper about <ahref="https://www.nature.com/articles/s41467-023-36296-4?utm_source=pocket_saves">pancreaticductal adenocarcinoma</a> (PDAC), published in <em>naturecommunication</em>.</p><p>It mainly studies human PDAC and applies scRNA sequencing on freshlycollected human PDAC samples before or after chemotherapy. The abstracthas three main results: 1) They find a heterogeneous mixture of basaland classical cancer cell subtypes, along with distinctcancer-associated fibroblast and macrophage subpopulations. 2) Classicaland basal-like cancer cells exhibit similar transcriptional responses tochemotherapy and do not demonstrate a shift towards a basal-liketranscriptional program among treated samples. 3) Ligand-receptorsdecrease interactions in treated samples, particularly between TIGIT onCD8 + T cells and its receptor on cancer cells, and identify TIGIT asthe significant inhibitory checkpoint molecule of CD8 + T cells.</p><p>Let us see how they analyze the three results.</p><p>One、How to judge the cut-off between basal and classical cancer cellsubtypes?</p><p>Here, the researchers found there is no difference between uponconditions.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/PDAC_1.png" /></p><p>All samples but one were comprised of a mixture of basal andclassical cancer cells in varying proportions.</p><blockquote><p>Although we did not observe this specific intermediate state genesignature (the number of samples in each dataset may limit thegeneralizability of such a signature), we did discover cancer cells innumerous patient samples that expressed both basal and classicalhistological markers to varying degrees.</p></blockquote><p>Two 、How to detect Classical and basal-like cancer cells exhibitingsimilar transcriptional responses?</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/PDAC_3.png" /></p><p>Through gene sets score, they found two groups' cells are mostlyoverlapped.</p><p>Three、How to ensure ligand-receptors decreased interactions intreated samples?</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/PDAC_2.png" /></p><p>They employed CellPhoneDB to infer potential ligand-receptorinteractions (LRIs) between malignant epithelial cells, TAM and CAFsubpopulations, CD8 +and CD4 + T cells, MDSCs, and DCs in naïve andtreated samples and found a general decrease of cell-cell interactionsin the chemotherapy-treated group by fold change value.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I read a new paper about &lt;a
href=&quot;https://www.nature.com/articles/s41467-023-36296-4?utm_source=pocket_saves&quot;&gt;pancreatic
ductal</summary>
      
    
    
    
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="tumor" scheme="http://example.com/tags/tumor/"/>
    
  </entry>
  
  <entry>
    <title>CESC and CC</title>
    <link href="http://example.com/2023/02/01/CESC%20and%20CC/"/>
    <id>http://example.com/2023/02/01/CESC%20and%20CC/</id>
    <published>2023-02-01T00:47:35.000Z</published>
    <updated>2023-03-09T12:13:50.469Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I have read two papers from one team and published in<em>Science Advance</em> and <em>Signal Transduction and TargetedTherapy</em>. one is named <em>Single-cell RNA-sequencing reveals radiochemotherapy-induced innate immune activation and MHC-II upregulation incervical cancer. The other is called </em>Single-cell dissection ofcellular and molecular features underlying human cervical squamous cellcarcinoma initiation and progression*. As we can see, these two papersstudy cervical squamous cell carcinoma (CESC) and cervical cancer (CC),both of which are based on single-cell sequencing technology.</p><p>From research ideas, they are similar, and both apply comparison todifferent conditions. For CESC, they sampled 13 human cervical tissuesat various stages of malignancy. For CC, they tested pre-RCT andpost-RCT tumor biopsies from patients with cervical cancer and adjacentnormal cervical tissues. I think this is an excellent performance ofmeasurement of variables on the experiment design.</p><p>On the analysis methods, they focus on the comparison betweenpre-condition and post-condition, such as, to test the percentage ofepithelia. Most importantly, these two papers' logic is constant or notdiverged, which is what I have learned.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I have read two papers from one team and published in
&lt;em&gt;Science Advance&lt;/em&gt; and &lt;em&gt;Signal Transduction and Targeted
Therapy</summary>
      
    
    
    
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="tumor" scheme="http://example.com/tags/tumor/"/>
    
  </entry>
  
  <entry>
    <title>iSpatial</title>
    <link href="http://example.com/2022/11/01/iSpatial/"/>
    <id>http://example.com/2022/11/01/iSpatial/</id>
    <published>2022-11-01T13:44:35.000Z</published>
    <updated>2023-03-09T11:55:05.851Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I read a paper named <em>Accurate inference of genome-widespatial expression with iSpatial</em>, from which I learned a lot.</p><p>iSpatial is used to infer expression patterns of all genes at highspatial resolution by integrating scRNA-seq and ST data. In the processof single-cell RNA sequencing, it can capture more genes as possible itcan. In this paper, the authors try to recover all genes' spatialinformation of the spatial transcriptomics data based on scRNA.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Accurate%20inference%20of%20genome-wide%20spatial%20expression%20with%20iSpatial%20Figure1.png" /></p><p>How do they infer spatial information?</p><p>In the first step, it needs to integrate scRNA and spatialtranscriptomics datasets. The core function is a weighted KNN graph. Foreach cell t in spatial transcriptome data, iSpatial searches the KNNs(<em>KNNt,k</em>).</p><p>Each gene's expression of cell t was calculated by the followingformula:</p><p><span class="math inline">\(K N N_{t, k}:\left\{K N N_{t, 1}, K NN_{t, 2}, \ldots, K N N_{t, k}\right\}\)</span></p><p>β is an argument to balance the expression from the spatialtranscriptome and scRNA-seq. ω is the weight factor that shows thedistance between cell t and other KNN neighbor cells. Through the belowformula, we can see the most similar neighbor cell, its weight factor issmaller.</p><p><span class="math inline">\(\widehat{E_t}=(1-\beta)E_t+\beta\left(\sum_k \omega_{t, k} E_{\mathrm{KNN}_{t,k}^{\prime}}\right)\)</span></p><p><span class="math inline">\(\operatorname{dist}\left(E_t,E_{\mathrm{KNN}_{t, k}^t}\right)=1-\operatorname{cor}\left(E_t,E_{\mathrm{KNN}_{t, k}^{\prime}}\right)\)</span></p><p><span class="math inline">\(d_{t, k}=\operatorname{dist}\left(E_t,E_{\mathrm{KNN}_{t, k}}\right)\)</span></p><p><span class="math inline">\(\omega_{t, k}=\frac{d_{t, k}^2}{\sum_kd_{t, k}^2}\)</span></p><p>But I think this method requires high quality of fitness betweenscRNA and spatial transcriptomics datasets.</p><p>And, the paper has developed a way to identify spatial variablegenes(SVGs). First, it divides the two-dimensional space into n x ngrids and calculates the gene mean expression level. Second, it randomlysamples the spatial location and calculates the mean gene expressionlevel once more. Finally, to compare whether there have significantdifferences between the two values.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I read a paper named &lt;em&gt;Accurate inference of genome-wide
spatial expression with iSpatial&lt;/em&gt;, from which I learned a lot.&lt;/</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>hdWGCNA</title>
    <link href="http://example.com/2022/09/22/hdWGCNA/"/>
    <id>http://example.com/2022/09/22/hdWGCNA/</id>
    <published>2022-09-22T09:40:25.000Z</published>
    <updated>2023-03-30T15:28:12.545Z</updated>
    
    <content type="html"><![CDATA[<p>How to deduce gene coexpression network is worth thinking.</p><p>I read the paper named "High dimensional co-expression networksenable discovery of transcriptomic drivers in complex biologicalsystems" which focus on gene co-expression networks.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/hdWGCNA_1.png" /></p><p>the signed correlation：</p><p><span class="math inline">\(a_{i,j}=\frac{1+\operatorname{cor}\left(x_i, x_j\right)}{2}\)</span></p><p>In order to emphasize strong correlations, we raise the elements of Ato a power β, and we refer to this as soft power thresholding.</p><p><span class="math inline">\(\begin{array}{r}\alpha_{i, j}=\left(a_{i,j}\right)^\beta \\ \tilde{\alpha}_{i, j}=\alpha_{i, j} \times\operatorname{sign}\left(\operatorname{cor}\left(x_i,x_j\right)\right)\end{array}\)</span></p><p>Now we have the gene-gene correlation raised to a power β, and analternative metric ̃ αi,j which also retains the sign of the correlationbetween these genes. The final co-expression network is then computed asa signed topological overlap matrix (TOM). The TOM describes sharedneighbors between the a pair of genes (i, j). We define the signed TOMas</p><p><span class="math inline">\(\operatorname{TOM}_{i, j}^{\text {signed}}=\frac{\left|\alpha_{i, j}+\sum_{u \neq i, j} \tilde{\alpha}_{i, u}\tilde{\alpha}_{u, j}\right|}{\min \left(k_i,k_j\right)+1-\left|\alpha_{i, j}\right|}\)</span></p><h1 id="reference">Reference</h1><ul><li><p>[1] <ahref="https://www.biorxiv.org/content/10.1101/2022.09.22.509094v1">hdWGCNA</a></p></li><li><p>[2] <ahref="http://rstudio-pubs-static.s3.amazonaws.com/554864_6e0f44cdc1474b8ba2c5f8326559bbe4.html">基因共表达网络WGCNA</a></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;How to deduce gene coexpression network is worth thinking.&lt;/p&gt;
&lt;p&gt;I read the paper named &quot;High dimensional co-expression networks
enable </summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
    <category term="co-expression" scheme="http://example.com/tags/co-expression/"/>
    
  </entry>
  
  <entry>
    <title>Anndata</title>
    <link href="http://example.com/2022/08/24/Anndata/"/>
    <id>http://example.com/2022/08/24/Anndata/</id>
    <published>2022-08-24T04:44:35.000Z</published>
    <updated>2023-03-09T12:18:04.153Z</updated>
    
    <content type="html"><![CDATA[<p>Anndata is a Python package for handling annotated data matrices inmemory and on disk (<ahref="http://github.com/theislab/anndata">github.com/theislab/anndata</a>),positioned between pandas and xarray.</p><h1 id="anndata-object">Anndata object</h1><p>What's its structure?</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/anndata_structure.svg" /></p><p>The AnnData object is a collection of arrays aligned to the commondimensions of observations (obs) and variables (var).</p><p>As we can see, color is used to denote elements of the object, with"orange" colors selected for elements aligned to the observations and"blue" colors for elements aligned to variables. The object is centeredaround the main data matrix X, whose two dimensions correspond toobservations and variables respectively. Primary labels for each ofthese dimensions are stored as obs_names and var_names. If needed,layers stores matrices of the exact same shape as X. One-dimensionalannotations for each dimension are stored in pandas DataFrames obs andvar. Multi-dimensional annotations are stored in obsm and varm. Pairwiserelationships are stored in obsp and varp. Unstructured data whichdoesn’t fit this model, but should stay associated to the dataset arestored in</p><h1 id="how-to-transfer-a-dataframe-to-anndata-object">How to transfer adataframe to anndata object</h1><p>Let's see an example.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/dataframe_example.png" /></p><p>This is a gene expression matrix, and I want to transfer it to ananndata object for analysis.</p><p>The first step is to read the dataframe file.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&quot;./Rep11_MOB_count_matrix-1.tsv&quot;</span>,sep=<span class="string">&quot;\t&quot;</span>,index_col=<span class="number">0</span>)</span><br><span class="line">df = df.T</span><br></pre></td></tr></table></figure><p>In an anndata object, obs and var are data frames. So, in the secondstep, we try to construct this elements.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">obs = pd.DataFrame()</span><br><span class="line">obs[<span class="string">&#x27;sample&#x27;</span>] = df.columns</span><br><span class="line">obs.index = <span class="string">&quot;mob_&quot;</span>+df.columns</span><br><span class="line">var_names = df.index</span><br><span class="line">var = pd.DataFrame(index=var_names)</span><br><span class="line">var[<span class="string">&quot;gene_ids&quot;</span>] = var.index</span><br><span class="line">X = df.T.values</span><br><span class="line">adata = anndata.AnnData(X, obs=obs, var=var,dtype=<span class="string">&#x27;int32&#x27;</span>)</span><br><span class="line">adata.var_names_make_unique() </span><br><span class="line">adata</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spa = pd.DataFrame(index=df.columns)</span><br><span class="line">spa[[<span class="string">&quot;x&quot;</span>,<span class="string">&quot;y&quot;</span>]] = spa.index.to_series().<span class="built_in">str</span>.split(<span class="string">&#x27;x&#x27;</span>, expand=<span class="literal">True</span>)</span><br><span class="line">adata.obsm[<span class="string">&quot;spatial&quot;</span>] = spa.to_numpy()</span><br><span class="line">adata</span><br></pre></td></tr></table></figure><h1 id="reference">Reference</h1><ul><li>[1] <ahref="https://www.biorxiv.org/content/10.1101/2021.12.16.473007v1.full">anndata:Annotated data</a></li><li>[2] <ahref="https://anndata.readthedocs.io/en/latest/tutorials/notebooks/getting-started.html">Gettingstarted with anndata</a></li><li>[3] <ahref="https://chanzuckerberg.github.io/scRNA-python-workshop/preprocessing/00-tabula-muris.html?utm_source=pocket_saves#Building-an-AnnData-object">Buildingan AnnData object</a></li><li>[4] <a href="https://www.biostars.org/p/9482750/">Pandas dataframeto H5ad file</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Anndata is a Python package for handling annotated data matrices in
memory and on disk (&lt;a
href=&quot;http://github.com/theislab/anndata&quot;&gt;gith</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="python" scheme="http://example.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>Gitto</title>
    <link href="http://example.com/2022/07/21/Giotto/"/>
    <id>http://example.com/2022/07/21/Giotto/</id>
    <published>2022-07-21T00:47:35.000Z</published>
    <updated>2023-03-09T12:18:18.498Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I read a toolbox <em>Giotto</em> to characterize spatialtranscriptomics data. It focus on three parts: 1) characterizing tissuecomposition; 2) spatial expression patterns; 3) cellularinteractions.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Giotto_Fig.%201.webp" /></p><p>In this literature, what interests me lost is these threeaspects.</p><h1 id="coherent-gene-expression">1、coherent gene expression</h1><p>In Giotto, it depends on two functions <em>detectSpatialCorGenes andclusterSpatialCorGenes.</em> The first function spatially smooths geneexpression through a grid averaging or k-nearest neighbor approach andthen calculates the gene-to-gene correlation (default = Pearson) scores.The second function performs hierarchical clustering to cluster thegene-to-gene co-expression network into modules and creates metagenescores by averaging all the genes for each identified co-expressionmodule</p><p>For my perspective, I don't approve the genes found by this methodare belong to gene co-expression relationship. I think they just havegene expression correlation.</p><h1 id="spatial-domain-detection">2、spatial domain detection</h1><p>Firstly, HMRF infers the state of each cell as the joint probabilityof the cell’s intrinsic state (inferred from the cell’s own geneexpression vector), and the cell’s extrinsic state, which is based onthe distribution of the states of the cell’s neighbors.</p><p>The neighborhood graph defines the extent of the neighbor cellinfluence, together with the parameter beta that defines the strength ofthe interaction of cells.</p><p>At the end, HMRF assigns each cell to one of k spatial domains (k tobe defined by the user).</p><h1 id="spatial-variable-genes">3、spatial variable genes</h1><p>For SVGs, the toolbox integrate methods such like SpatialDE, SPARK,Trendsceek and BinSpect.</p><h1 id="cell-cell-communication">4、cell-cell communication</h1><p>This is implemented in the function <em>spatCellCellcom.</em></p><p><span class="math inline">\(\overline{S(L, R, A, B)}=\frac{1}{n}\sum_{i=1}^n L_i+\frac{1}{m} \sum_{j=1}^m R_j\)</span></p><p>where <span class="math inline">\(n\)</span> represents the number ofA-type cells that interact with B-type cells, <spanclass="math inline">\(m\)</span> represents the number of B-type cellsthat interact with A-type cells, <spanclass="math inline">\(L_{i}\)</span> represents the expression level ofthe ligand in the ith A-type cell, and <spanclass="math inline">\(R_{j}\)</span> represents the expression level ofthe receptor in the jth B-type cell.</p><p>And how to do the statistic test?</p><p>This background distribution is created by shuffling cell locationswithin the same cell type for A and B for 1000 (= default) times. Ineach round, a permutation score Sp is calculated using the same formula.Associated p values were calculated as the probability of Sp to begreater or smaller than the actual observed score S.Thep values for allligand-receptor pairs in all cell-type pairs were subsequently adjustedfor multiple hypothesis testing.</p><h1 id="reference">Reference</h1><ul><li>[1] <ahref="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-021-02286-2">Giotto</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I read a toolbox &lt;em&gt;Giotto&lt;/em&gt; to characterize spatial
transcriptomics data. It focus on three parts: 1) characterizing tissu</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>scGCO</title>
    <link href="http://example.com/2022/06/10/ScGCO/"/>
    <id>http://example.com/2022/06/10/ScGCO/</id>
    <published>2022-06-10T00:47:35.000Z</published>
    <updated>2023-03-30T03:17:32.576Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I read a fantastic literature about finding SVGs throughHMMF and graph cuts algorithm named <em>Identification of spatiallyvariable genes with graph cuts</em>.</p><h1 id="part1">Part1</h1><p>Firstly, we must figure out why finding SVGs is critical in spatialtranscriptomics?</p><p>Firstly, SVGs are defined as genes whose expression distributionsdisplay significant dependence on their spatial locations.</p><h1 id="part1-1">Part1</h1><p>In this paper, it mentions three reasons:</p><p>1、SVGs could demonstrate strong conservation in their spatialpatterns, such that many SV genes display similar dependencies onspatial locations, resulting in similar trends in spatial patterns oftheir expression values.</p><p>2、SVGs are often markers or essential regulators for tissue patternformation and homeostasis.</p><p>3、Although these methods demonstrated usefulness in identifying SVgenes, they cannot illustrate the exact boundaries of regionsdemonstrating spatial dependence, which are often of biologicalinterest, and more importantly, these algorithms have computationalefficiency of O(n2)orworseandareunsuitable for analyzing large spatialtranscriptomics datasets.</p><h1 id="part2">Part2</h1><p>How does this paper identify SVGs？</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/ScGCO_Fig.%201.webp" /></p><p>As the above picture illustrated, firstly, to model the spatial geneexpression data with HMRF, scGCO first employs Delaunay triangulation totransform spatial locations of measured cells/spots into an undirectedgraph, where each node represents a data point (a single cell or a spotmeasuring multiple cells, depending on the technologies utilized) in thespatial transcriptomics data.</p><p>Secondly, scGCO utilizes Gaussian mixture modeling to separate agene’s expression values into different bins, which represent differentgene expression states. The float gene expression value associated witheach node in the HMRF was then transformed into the corresponding binnumber, and the resulting bin number was assigned to the node, creatingan initial label assignment for the HMRF.</p><p>Thirdly, The initialized HMRF was then optimized by the fast graphcuts algorithm of Boykov to learn the true hidden labels of the nodes inHMRF, which represent authentic gene expression states.</p><p>Fourthly, the p-value for each gene was evaluated using the bestsegmentation under the complete spatial randomness (CSR) framework.Benjamini–Hochberg (BH) correction was utilized to identify spatiallyvariable (SV) genes at the genome-scale.</p><h1 id="reference">Reference</h1><ul><li>[1] <ahref="https://www.nature.com/articles/s41467-022-33182-3">Identificationof spatially variable genes with graph cuts</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I read a fantastic literature about finding SVGs through
HMMF and graph cuts algorithm named &lt;em&gt;Identification of spatially
va</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>What is cancer metabolism?</title>
    <link href="http://example.com/2022/05/02/GSVA/"/>
    <id>http://example.com/2022/05/02/GSVA/</id>
    <published>2022-05-02T07:47:35.000Z</published>
    <updated>2023-03-09T12:19:06.027Z</updated>
    
    <content type="html"><![CDATA[<p>Gene Set Variation Analysis is a method to calculate genesets pathwayscores across different samples.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/GSVA_1.jpg" /></p><p>Firstly, there has an input gene expression matrix. We performnon-parametric kernel estimation of a specific gene's cumulative densityfunction.</p><p>In the case of microarray data, a Gaussian kernel is used:</p><p><span class="math inline">\(\widehat{F}_{h_i}\left(x_{ij}\right)=\frac{1}{n} \sum_{k=1}^n \int_{-\infty}^{\frac{x_{i j}-x_{ik}}{h_i}} \frac{1}{\sqrt{2 \Pi}} e^{-\frac{t^2}{2}} d t\)</span></p><p>In the case of RNA-seq data, a discrete Poisson kernel isemployed:</p><p><span class="math inline">\(\widehat{F}_r\left(x_{ij}\right)=\frac{1}{n} \sum_{k=1}^n \sum_{y=0}^{x_{i j}}\frac{e^{-\left(x_{i k}+r\right)}\left(x_{i k}+r\right)^y}{y!}\)</span>,</p><p>The cumulative density function is estimated for every gene using allsamples from the above distributions. In simpler terms, a CDF value isassigned to each gene in each sample.</p><p>With the CDF of all genes in each sample, we sort them from largestto smallest.</p><p>Secondly, we normalize the rank values. <spanclass="math inline">\(r_i\)</span> is the rank value of the gene <spanclass="math inline">\(i\)</span> in sample <spanclass="math inline">\(S\)</span>, <span class="math inline">\(p\)</span>is the gene number.</p><p><span class="math inline">\(z_{ij}=\left|\frac{p}{2}-r_i\right|\)</span></p><p>Thirdly, to calculate <span class="math inline">\(ES(s)\)</span> withsort <span class="math inline">\(z_{i j}\)</span></p><p><span class="math inline">\(\nu_{jk}(\ell)=\frac{\sum_{i=1}^{\ell}\left|r_{i j}\right|^\tau I\left(g_{(i)}\in \gamma_k\right)}{\sum_{i=1}^p\left|r_{i j}\right|^\tauI\left(g_{(i)} \in \gamma_k\right)}-\frac{\sum_{i=1}^{\ell}I\left(g_{(i)} \notin\gamma_k\right)}{p-\left|\gamma_k\right|}\)</span>,</p><p><span class="math inline">\(E S_{j k}^{\text {diff }}=\left|E S_{jk}^{+}\right|-\left|E S_{j k}^{-}\right|=\max _{\ell=1, \ldots,p}\left(0, v_{j k}(\ell)\right)-\min _{\ell=1, \ldots, p}\left(0, v_{jk}(\ell)\right)\)</span>,</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/GSVA-2.webp" /></p><h1 id="reference">Reference</h1><ul><li>[1] <ahref="https://towardsdatascience.com/decoding-gene-set-variation-analysis-8193a0cfda3">DecodingGene Set Variation Analysis</a></li><li>[2] <ahref="https://www.jianshu.com/p/47f9f0107ffe">GSA、GSEA、ssGSEA、GSVA的算法原理及它们的联系与区别</a></li><li>[3] <ahref="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3618321/">GSVA: geneset variation analysis for microarray and RNA-Seq data</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Gene Set Variation Analysis is a method to calculate genesets pathway
scores across different samples.&lt;/p&gt;
&lt;p&gt;&lt;img
src=&quot;https://raw.githu</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
  </entry>
  
  <entry>
    <title>SOMDE</title>
    <link href="http://example.com/2022/04/20/SOMDE/"/>
    <id>http://example.com/2022/04/20/SOMDE/</id>
    <published>2022-04-20T02:23:35.000Z</published>
    <updated>2023-03-18T13:40:08.312Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I read a paper to identify spatial variable genes named"<em>SOMDE: a scalable method for identifying spatially variable geneswith self-organizing map</em>."</p><h1 id="part1">Part1</h1><p>As its abstract shows:</p><blockquote><p>We present SOMDE, an efficient method for identifying SVgenes inlarge-scale spatial expression data. SOMDE uses the self-organizing mapto cluster neighboring cells into nodes and then uses a Gaussian processto fit the node-level spatial gene expression to identify SVgenes.Experiments show that SOMDE is about 5–50 times faster than existingmethods with comparable results. The adjustable resolution of SOMDEmakes it the only way to give results in 5 min in large datasets of morethan 20 000 sequencing sites. SOMDE is available as a python package onPyPI at https://pypi.org/project/somde for educational use.</p></blockquote><p>So, what is the self-organizing map?</p><p>A self-organizing map (SOM) is a type of <ahref="https://en.wikipedia.org/wiki/Artificial_neural_network">artificialneural network</a> (ANN) that is trained using unsupervised learning toproduce a low-dimensional (typically two-dimensional), discretizedrepresentation of the input space of the training samples, called a map,and is therefore, a method to make dimensionality reduction.Self-organizing maps differ from other artificial neural networks asthey apply competitive learning instead of error-correction education(such as backpropagation with gradient descent) because they use aneighborhood function to preserve the topological properties of theinput space.</p><h1 id="part2">Part2</h1><p>And, how does it work in the paper?</p><p>Let us see this figure.</p><p><span class="math inline">\(N^2 \times k=C\)</span></p><p>where C is a constant representing the total number of data sites,and k is the model parameter called the neighbor number, which denotesthe expected average number of original data sites each SOM noderepresents. This parameter controls how condensed the learned SOM is. Alarger k means higher condensation.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/somde.jpeg.jpg" /></p><p>As it showed in (a), it initializes the value and dimension of SOMNode weight <span class="math inline">\(M=(m_1,m_2,m_{N*N})\)</span> ,like the orange spots. After initialization, SOM adjusts the weight ofeach node toward the tissue spatial topology through a repetitivetraining process using all spatial coordinates <spanclass="math inline">\(X=(X_1,X_2,X_3,X_C)\)</span> as traniningsamples.</p><p>Cycle after cycle. After training, each data site maps to a uniqueSOM node. Each SOM node represents the group of sites that are mapped toit. Node weights in the learned SOM can be treated as new spatialcoordinates for the data sites. The new spatial locations <spanclass="math inline">\(X=\left(\tilde{x}_1, \tilde{x}_2, \ldots,\tilde{x}_{N \times N}\right)\)</span> compose the sparse topology ofthe original data</p><p>In a SOM node, to define its gene expression as the linearcombination of the max value and average value of the gene expression inthe group of sites that the node represents. The reason for not usingaverage value as a meta-expression is due to the high sparsity inlarge-scale data that could bias the result.</p><p><span class="math inline">\(\tilde{\boldsymbol{Y}}_{i, j}=\gamma\cdot \max \left(y_{S 1}, y_{S 2}, \ldots\right)+(1-\gamma) \cdot\operatorname{avg}\left(y_{S 1}, y_{S 2}, \ldots\right)\)</span></p><p>where <span class="math inline">\(y_{S 1}\)</span> is the expressionvalue of the gene at the data site <span class="math inline">\(x_{S1}\)</span>. The combination ratio <spanclass="math inline">\(\gamma\)</span> balances the local maximum andmean gene expression. We use <span class="math inline">\(\gamma =0.5\)</span> as the default in current experiments.</p><p>With this computational model, how to deduce SVGs?</p><p><span class="math inline">\(p\left(\tilde{\boldsymbol{y}} \midH_{\mathrm{G}}, \tilde{\boldsymbol{X}},\Theta\right)=\mathcal{N}\left(\tilde{\boldsymbol{y}} \mid \mu \cdot 1,\sigma_s^2 \cdot \boldsymbol{\Sigma}_{k(\tilde{\boldsymbol{x}},\widetilde{\boldsymbol{x}} \mid \theta)}+\delta \cdot\boldsymbol{I}\right)\)</span></p><p>where <span class="math inline">\(\tilde{\boldsymbol{y}}\)</span>denotes one gene meta-expression in the SOM plane and <spanclass="math inline">\(\tilde{\boldsymbol{X}}\)</span> denotes SOM nodelocations.</p><p><span class="math inline">\(\delta \cdot \boldsymbol{I}\)</span>indicates the non-spatial variance given by Gaussian distributed noisein all observed gene meta-expressions. <spanclass="math inline">\(\boldsymbol{\Sigma}_{k(\tilde{\boldsymbol{x}},\widetilde{\boldsymbol{x}} \mid \theta)}\)</span> captures the spatialvariation by using a selected kernel function <spanclass="math inline">\(k(\cdot)\)</span></p><p>Compared with the original Gaussian process model, model HG assumesone gene meta-expression at all spatial locations has the same meanvalue l so that the non-spatial variance cannot be regressed out. Thusthe maximum likelihood value of HG mainly depends on spatialvariance.</p><h1 id="reference">Reference</h1><ul><li>[1] <ahref="https://medium.com/@abhinavr8/self-organizing-maps-ff5853a118d4">SelfOrganizing Maps</a></li><li>[2] <ahref="https://academic.oup.com/bioinformatics/article/37/23/4392/6308937">SOMDE:a scalable method for identifying spatially variable genes withself-organizing map</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I read a paper to identify spatial variable genes named
&quot;&lt;em&gt;SOMDE: a scalable method for identifying spatially variable genes
</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>Hotspot</title>
    <link href="http://example.com/2022/03/01/Hotspot/"/>
    <id>http://example.com/2022/03/01/Hotspot/</id>
    <published>2022-03-01T08:47:35.000Z</published>
    <updated>2023-03-09T12:18:57.402Z</updated>
    
    <content type="html"><![CDATA[<p>Hotspot is a useful tools to find gene expression module, especiallyin tumor spatial transcriptome.</p><p>Now, I want to introduce its work principle.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/hotspot_1.jpg" /></p><p>To compute gene modules, Hotspot uses a three-step procedure:</p><p>1、Find informative genes with high local autocorrelation</p><p>Firstly, to compute cells similarity map through KNN graph or spatialposition or development lineage.</p><p>For an interested gene <span class="math inline">\(x\)</span>, tocalculate its <span class="math inline">\(H_x\)</span>. <spanclass="math display">\[H_x=\sum_j \sum_{j \neq i} w_{i j} x_i x_j\]</span> If cell <span class="math inline">\(i\)</span> and cell <spanclass="math inline">\(j\)</span> are nearest neighbors, then weight<span class="math inline">\(w_{ij}\)</span> is higher then dissimilarcells. If cell <span class="math inline">\(i\)</span> and cell <spanclass="math inline">\(j\)</span> are denifitely different, then weight<span class="math inline">\(w_{ij}\)</span> is equal to 0.</p><p><span class="math inline">\(x_i\)</span> and <spanclass="math inline">\(x_j\)</span> are gene <spanclass="math inline">\(x\)</span> expression value in cell <spanclass="math inline">\(i\)</span> and cell <spanclass="math inline">\(j\)</span> . Notably, whether <spanclass="math inline">\(x_i\)</span> or <spanclass="math inline">\(x_j\)</span> is standardized expression value(such that <span class="math display">\[E\left[x_i\right]=0\]</span>，<span class="math display">\[E\left[x_i^2\right]=1\]</span>).</p><p>But, how to evaluate <span class="math inline">\(H_x\)</span> anddetect informative genes?</p><p>For each gene, to define a null model in which the expression valuesare drawn independently from some assumed distribution and transfer<span class="math inline">\(H_x\)</span> to <em>Z-score</em> to eveluatestatistically significant. <span class="math display">\[\hat{Z}=\frac{\widehat{H}-\mathrm{E}[\hat{H}]}{\operatorname{var}(\widehat{H})^{\frac{1}{2}}}=\frac{\sum_i\sum_j w_{i j} \widehat{X_i} \widehat{X}_j}{\left(\sum_i \sum_j w_{ij}^2\right)^{\frac{1}{2}}}\]</span> Through this formula, the method measures cell’s expression byits local neighborhood in the graph. Finally, <spanclass="math inline">\(\hat{Z}\)</span> represents gene expressionvalue.</p><p>2、Evaluate pair-wise local correlations between genes</p><p>In the first step, we can identify informative genes. <spanclass="math display">\[H_{x y}=\sum_i \sum_{j \neq i} w_{i j}\left(x_i y_j+y_i x_j\right)\]</span> Here, the <span class="math inline">\(i\)</span>, <spanclass="math inline">\(j\)</span> indices represent individual cells and<span class="math inline">\(x_i\)</span> and <spanclass="math inline">\(y_i\)</span> are the standardized expressionvalues in cell <span class="math inline">\(i\)</span> for genes <spanclass="math inline">\(x\)</span> and <spanclass="math inline">\(y\)</span>, respectively. Weights <spanclass="math inline">\(w_{ij}\)</span> are defined as before based on thecell similarity map. As with <span class="math inline">\(H_{x}\)</span>,the null model is again used to convert <spanclass="math inline">\(H_{xy}\)</span> values into <spanclass="math inline">\(Z\)</span> scores. <span class="math display">\[\mathrm{E}\left[H_{x y}^2\right]=\sum_i^N\left(\sum_{j \in N(i)} w_{i j}\hat{x}_j\right)^2\]</span></p><p>3、Cluster the resulting gene-gene affinity matrix</p><p>Through applying a bottom-up clustering procedure with two parameters<em>min_cluster_genes</em>, and <em>fdr_threshold</em> to cluster thesegenes into module.</p><p>If a module accumulates more than <em>min_cluster_genes</em>, then itis assigned a label.</p><p>The <em>fdr_threshold</em> parameter is used to set a minimumsignificant <em>Z-score</em>. If at any point in the above mergingmodule procedure the maximal Z-score falls below this threshold, theprocedure halts as further gene assignments fall below the significancethreshold and are therefore ambiguous.</p><h1 id="reference">Reference:</h1><ul><li>[1] <ahref="https://www.cell.com/cell-systems/fulltext/S2405-4712(21)00114-9">Hotspotidentifies informative gene modules across modalities of single-cellgenomics</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Hotspot is a useful tools to find gene expression module, especially
in tumor spatial transcriptome.&lt;/p&gt;
&lt;p&gt;Now, I want to introduce its </summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>SCENIC</title>
    <link href="http://example.com/2022/02/15/SCENIC/"/>
    <id>http://example.com/2022/02/15/SCENIC/</id>
    <published>2022-02-15T10:47:35.000Z</published>
    <updated>2023-03-09T12:18:39.063Z</updated>
    
    <content type="html"><![CDATA[<p>SCENIC is a computational method to deduce gene regulatorynetworks.</p><p>The main progress has three parts.</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/scenic_1.webp" /></p><p>Part1. GENIE3</p><p>Through GENIE3 to identify genesets coexpressed with TF genes.</p><p>The method assumes that a specific gene expression depends on theother genes' expression in the network.</p><p>Denoting by <span class="math inline">\(x_k^{j-1}\)</span> the vectorcontaining the expression values in the <spanclass="math inline">\(k_{th}\)</span> the experiment of all genes exceptgene <em>j</em>:</p><p><span class="math inline">\(\mathbf{x}_k^{-j}=\left(x_k^1, \ldots,x_k^{j-1}, x_k^{j+1}, \ldots, x_k^p\right)^{\mathrm{T}}\)</span></p><p>Then,</p><p><spanclass="math inline">\(x_k^j=f_j\left(\mathbf{x}_k^{-j}\right)+\varepsilon_k,\forall k\)</span> , where <spanclass="math inline">\(\varepsilon_k\)</span> is a random noise with zeromeans (conditionally to <spanclass="math inline">\(\mathbf{x}_k^{-j}\)</span>)</p><p>For <em>j</em> = 1 to <em>p</em>:</p><ul><li>Generate the learning sample of input-output pairs for gene<em>j</em>:</li></ul><p><span class="math inline">\(L S^j=\left\{\left(\mathbf{x}_k^{-j},x_k^j\right), k=1, \ldots, N\right\}\)</span></p><ul><li><p>Use a feature selection technique on <spanclass="math inline">\(L S^j\)</span> to compute confidence levels <spanclass="math inline">\(w_{i, j}, \forall i \neq j\)</span>, for all genesexcept gene <em>j</em> itself.</p></li><li><p>Aggregate the <em>p</em> individual gene rankings to get a globalscale of all regulatory links.</p></li></ul><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/GENIE3.png" /></p><p>Part2. RcisTarget</p><p>RcisTarget identifies enriched TF-binding motifs and candidatetranscription factors for a gene list.</p><p>In these two steps:</p><p>Step 1 selects DNA motifs significantly over-represented in thesurroundings of the transcription start site (TSS) of the genes in thegene set.</p><p>Step 2, RcisTarget predicts candidate target genes (i.e., genes inthe gene set that are ranked above the leading edge), like enrichmentanalysis.</p><p>Part3. AUCell</p><p>The input of AUCell is a regulon that contains TF and regulatedgenes.</p><p>AUCell calculates the enrichment of the regulon as an area under therecovery curve (AUC) across the ranking of all genes in a particularcell, whereby genes are ranked by their expression value.</p><h1 id="reference">Reference</h1><ul><li>[1] <ahref="https://www.nature.com/articles/nmeth.4463">SCENIC</a></li><li>[2] <ahref="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0012776">GENIE3</a></li><li>[3] <ahref="https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.1000435">RcisTarget</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;SCENIC is a computational method to deduce gene regulatory
networks.&lt;/p&gt;
&lt;p&gt;The main progress has three parts.&lt;/p&gt;
&lt;p&gt;&lt;img
src=&quot;https://r</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>SpatialDE</title>
    <link href="http://example.com/2022/01/20/SpatialDE/"/>
    <id>http://example.com/2022/01/20/SpatialDE/</id>
    <published>2022-01-20T14:17:09.000Z</published>
    <updated>2023-03-17T12:13:18.444Z</updated>
    
    <content type="html"><![CDATA[<p>To some degree, SpatialDE is the first literature focused on spatialvariable genes(SVGS).</p><p><imgsrc="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/spatialde_figure1.webp" /></p><p>Now, I would like to intriduce the algorithm principle.</p><p>Its method depend on Gaussian process regression. For each gene,SpatialDE decomposes expression variability into spatial and nonspatialcomponents, using two random effect terms: a spatial variance term thatparametrizes gene expression covariance by pairwise distances ofsamples, and a noise term that models nonspatial variability.</p><p><span class="math inline">\(P\left(y \mid \mu, \sigma_s^2, \delta,\Sigma\right)=N\left(y \mid \mu \cdot 1, \sigma_s^2 \cdot(\Sigma+\delta\cdot I)\right)\)</span></p><p><span class="math inline">\(y\)</span> represents the observed geneexpression levels, <span class="math inline">\(μ\)</span> represents themean expression level, <span class="math inline">\(\sigma_s^2\)</span>represents the variance of the expression levels, <spanclass="math inline">\(δ\)</span> represents the spatial variance, and<span class="math inline">\(Σ\)</span> represents the covariance matrixof the spatial coordinates.</p><p><span class="math inline">\(\Sigma_{i, j}=k\left(x_i, x_j\right)=\exp\left(-\frac{\left|x_i-x_j\right|^2}{2 \cdot l^2}\right)\)</span></p><p><span class="math inline">\(x_i\)</span> and <spanclass="math inline">\(x_j\)</span> represent the spatial coordinates oftwo locations, and <span class="math inline">\(l\)</span> is a parameterthat determines the scale of the distance over which the similaritybetween the locations is calculated. The function calculates thesimilarity between the two locations as a value between 0 and 1, withhigher values indicating greater similarity.</p><p>The second covariance term <span class="math inline">\(δ ·I\)</span>accounts for independent nonspatial variation in gene expression, wherethe ratio <span class="math inline">\(1/(1 + δ)\)</span> can beinterpreted as the fraction of expression variance attributable tospatial effects. Model parameters are fit by maximizing the marginal loglikelihood (LL)</p><p><span class="math inline">\(\begin{aligned} L L= &amp; -\frac{1}{2}\cdot N \cdot \log (2 \pi)-\frac{1}{2} \cdot \log \left(\left|\sigma_s^2\cdot(\Sigma+\delta \cdot I)\right|\right) \\ &amp; -\frac{1}{2}\cdot(y-\mu \cdot 1)^T\left(\sigma_s^2 \cdot(\Sigma+\delta \cdotI)\right)^{-1}(y-\mu \cdot 1)\end{aligned}\)</span></p><p>To estimate statistical significance, it compared the modellikelihood of the fitted SpatialDE model with the likelihood of a modelthat corresponds to the null hypothesis of no spatial covariance,</p><p><span class="math inline">\(P\left(y \mid \mu,\sigma^2\right)=N\left(\mu \cdot 1, \sigma^2 \cdot I\right)\)</span></p><p>Then estimating <em>P</em> values analytically on the basis of the χ2distribution transformation with one degree of freedom.</p><h1 id="reference">Reference</h1><ul><li>[1] <a href="https://www.nature.com/articles/nmeth.4636">SpatialDE:identification of spatially variable genes</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;To some degree, SpatialDE is the first literature focused on spatial
variable genes(SVGS).&lt;/p&gt;
&lt;p&gt;&lt;img
src=&quot;https://raw.githubusercontent</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>GO enrichment</title>
    <link href="http://example.com/2022/01/01/GO%20enrichment/"/>
    <id>http://example.com/2022/01/01/GO%20enrichment/</id>
    <published>2022-01-01T05:47:35.000Z</published>
    <updated>2023-03-09T12:20:13.300Z</updated>
    
    <content type="html"><![CDATA[<p>GO enrichment analysis is a prevalent method to characterizegenesets' profiles.</p><p>What does it mean?</p><p>GO is the gene ontology, a structured, controlled vocabulary forclassifying gene function at the molecular and cellular levels. It isdivided into three separate sub-ontologies: biological process (e.g.,signal transduction), molecular function (e.g., ATPase activity), andcellular component (e.g., ribosome)[^1].</p><p>How to calculate GO term scores?</p><p>To Calculate p-values through a hypergeometric distribution test.</p><p>We have a geneset containing <em>n</em> and <em>k</em> genes in onespecific GO term. All GO terms have <em>N</em> genes. For one particularGO term, there have K genes.</p><p>The hypergeometric distribution measures precisely the probability of<strong>k</strong> successes in <strong>n</strong> draws, withoutreplacement, from a finite population of size <strong>N</strong> thatcontains exactly <strong>K</strong> successful objects:</p><p><spanclass="math inline">\(\mathrm{P}(\mathrm{X}=k)=\frac{\left(\begin{array}{l}K\\ k\end{array}\right)\left(\begin{array}{l}N-n \\K-k\end{array}\right)}{\left(\begin{array}{l}N \\n\end{array}\right)}\)</span></p><p><spanclass="math inline">\(\mathrm{p-value}=1-\mathrm{P}(\mathrm{X}=k)\)</span></p><h1 id="reference">Reference</h1><p>[1]https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/goenrichment/tutorial.html</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;GO enrichment analysis is a prevalent method to characterize
genesets&#39; profiles.&lt;/p&gt;
&lt;p&gt;What does it mean?&lt;/p&gt;
&lt;p&gt;GO is the gene ontology</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
  </entry>
  
</feed>
