<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Qian&#39;s blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2023-06-29T10:08:17.569Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Qian Li</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Spatial mapping reveals human adipocyte subpopulations with distinct sensitivities to insulin</title>
    <link href="http://example.com/2023/06/29/Spatial-mapping-reveals-human-adipocyte-subpopulations-with-distinct-sensitivities-to-insulin/"/>
    <id>http://example.com/2023/06/29/Spatial-mapping-reveals-human-adipocyte-subpopulations-with-distinct-sensitivities-to-insulin/</id>
    <published>2023-06-29T09:37:41.000Z</published>
    <updated>2023-06-29T10:08:17.569Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Spatial-mapping-reveals-human-adipocyte-subpopulations-with-distinct-sensitivities-to-insulin"><a href="#Spatial-mapping-reveals-human-adipocyte-subpopulations-with-distinct-sensitivities-to-insulin" class="headerlink" title="Spatial mapping reveals human adipocyte subpopulations with distinct sensitivities to insulin"></a>Spatial mapping reveals human adipocyte subpopulations with distinct sensitivities to insulin</h1><h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>“The contribution of cellular heterogeneity and architecture to white adipose tissue (WAT) function is poorly understood. Herein, we combined spatially resolved transcriptional profiling with single-cell RNA sequencing and image analyses to map human WAT composition and structure. This identified 18 cell classes with unique propensities to form spatially organized homo- and heterotypic clusters. Of these, three constituted mature adipocytes that were similar in size, but distinct in their spatial arrangements and transcriptional profiles. Based on marker genes, we termed these AdipoLEP, AdipoPLIN, and AdipoSAA. We confirmed, in independent datasets, that their respective gene profiles associated differently with both adipocyte and whole-body insulin sensitivity. Corroborating our observations, insulin stimulation in vivo by hyperinsulinemic-euglycemic clamp showed that only AdipoPLIN displayed a transcriptional response to insulin. Altogether, by mining this multimodal resource we identify that human WAT is composed of three classes of mature adipocytes, only one of which is insulin responsive.” (Bäckdahl 等, 2021, p. 1869)</p><h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Figure%20thumbnail%20gr1.jpg" alt=""></p><p>Figure 1 shows the basic analysis of ST and scRNA data. </p><p>In the above figure, if the spot has 6 neighbors, its degree scores is 6.</p><p>How to calculate homotypic score?</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Figure%20thumbnail%20gr2.jpg" alt=""></p><p>In the above figure, if the spot has 6 neighbors, its degree scores is 6.</p><p>How to calculate homotypic score?</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/20230629_fig1.png" alt=""></p><p>For each network, the arverage degree was calculated as $\bar{k}=2 L / N$，where L and N, respectively, corresponds to the total number of edges and nodes (spots) in the network.</p><p>But to evaluate the gap between real degree and expected degree and account for difference in network size, the authors choose the average degree was computed for random networks where the spots’ classifications had been shuffled within each sample. This process was repeated 50 times in order to obtain an ‘‘expected’’ average degree.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Figure%20thumbnail%20gr3.jpg" alt=""></p><p>How to calculate Heterotypic score?</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/20230629_fig2.png" alt=""></p><p>If two classes are distinct, the score would be small.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1] <a href="https://www.cell.com/cell-metabolism/fulltext/S1550-4131(21">Spatial mapping reveals human adipocyte subpopulations with distinct sensitivities to insulin</a>00363-6)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Spatial-mapping-reveals-human-adipocyte-subpopulations-with-distinct-sensitivities-to-insulin&quot;&gt;&lt;a href=&quot;#Spatial-mapping-reveals-hum</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>SRTsim</title>
    <link href="http://example.com/2023/03/06/SRTsim/"/>
    <id>http://example.com/2023/03/06/SRTsim/</id>
    <published>2023-03-06T03:09:24.000Z</published>
    <updated>2023-03-30T04:59:00.947Z</updated>
    
    <content type="html"><![CDATA[<p>Today, I read a paper, “SRTsim: spatial pattern preserving simulations for spatially resolved transcriptomics” used to produce simulated data in spatial transcriptomics.</p><p>This is the main work process</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/SRTsim_1.png" alt=""></p><p>What impresses me most is the way to test the advantages of SRTsim. It calculated the rand index between real data and simulated data through various of clustering methods.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>[1] <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-023-02879-z">SRTsim: spatial pattern preserving simulations for spatially resolved transcriptomics</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Today, I read a paper, “SRTsim: spatial pattern preserving simulations for spatially resolved transcriptomics” used to produce simulated </summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>Spatial profiling technologies illuminate the tumor microenvironment</title>
    <link href="http://example.com/2023/03/04/Spatial%20profiling%20technologies%20illuminate%20the%20tumor%20microenvironment/"/>
    <id>http://example.com/2023/03/04/Spatial%20profiling%20technologies%20illuminate%20the%20tumor%20microenvironment/</id>
    <published>2023-03-04T00:44:35.000Z</published>
    <updated>2023-06-29T09:47:33.761Z</updated>
    
    <content type="html"><![CDATA[<p>In this review, most interesting is the figure which depicts the advantages of in Spatial transcriptome in cancer research.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Spatial%20profiling%20technologies%20illuminate%20the%20tumor%20microenvironment_fig4.png" alt=""></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;In this review, most interesting is the figure which depicts the advantages of in Spatial transcriptome in cancer research.&lt;/p&gt;
&lt;p&gt;&lt;img s</summary>
      
    
    
    
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
    <category term="cancer" scheme="http://example.com/tags/cancer/"/>
    
    <category term="review" scheme="http://example.com/tags/review/"/>
    
  </entry>
  
  <entry>
    <title>What is cancer metabolism?</title>
    <link href="http://example.com/2023/03/03/What%20is%20cancer%20metabolism?/"/>
    <id>http://example.com/2023/03/03/What%20is%20cancer%20metabolism?/</id>
    <published>2023-03-03T00:47:35.000Z</published>
    <updated>2023-03-09T12:03:22.762Z</updated>
    
    <content type="html"><![CDATA[<p>What is cancer metabolism? This is something to think about. </p><p>And I have read the paper <em>What is cancer metabolism?</em> </p><p>What I learned is mainly two parts.</p><p>First, For tumor cells, it chooses to produce lactate even if oxygen is abundant.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Figure1.%20Warburg%20and%20Pasteur%20eff" alt=""></p><p>Second, Nutrient uptake is largely initiated by receptor tyrosine kinases (RTKs) which activate signaling cascades that promote the membrane localization of nutrient transporters and activity of enzymes that metabolize—and therefore help capture—nutrients. Signaling pathways downstream of PI3K, most notably RAS, can also direct bulk uptake of macromolecules via macropinocytosis. Nutrient uptake is also facilitated by transcriptional induction of membrane transporters via oncogenic transcription factors hypoxia-inducible factor (HIF), which activates genes encoding plasma membrane glucose transporters (Glut), and MYC, which activates genes encoding amino acid transporters such as Asct2. Genes frequently mutated or activated in cancer are colored orange.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Figure2.%20Mechanisms%20of%20nutrient" alt=""></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;What is cancer metabolism? This is something to think about. &lt;/p&gt;
&lt;p&gt;And I have read the paper &lt;em&gt;What is cancer metabolism?&lt;/em&gt; &lt;/p&gt;
&lt;</summary>
      
    
    
    
    
    <category term="cancer" scheme="http://example.com/tags/cancer/"/>
    
    <category term="review" scheme="http://example.com/tags/review/"/>
    
    <category term="metabolism" scheme="http://example.com/tags/metabolism/"/>
    
  </entry>
  
  <entry>
    <title>SpaCST</title>
    <link href="http://example.com/2023/02/28/SpaCST/"/>
    <id>http://example.com/2023/02/28/SpaCST/</id>
    <published>2023-02-28T13:44:35.000Z</published>
    <updated>2023-03-09T12:18:46.491Z</updated>
    
    <content type="html"><![CDATA[<p>SpaCET is a toolbox mainly focused on cancer areas in spatial transcriptomics. </p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/spacet_figure1.webp" alt=""></p><p>First, SpaCET estimates malignant cell fractions based on a gene pattern dictionary of copy number alterations (CNA) and malignant transcriptome signatures across common tumor types.</p><p>Second, SpaCET deconvolves nonmalignant cell fractions and adjusts cell densities under a unified linear model. Using scRNA-seq datasets from diverse cancer types, we defined reference expression profiles of immune and stromal cells in a hierarchical lineage</p><p>Third, SpaCET infers intercellular interactions based on cell colocalization and ligand–receptor co-expression analysis.</p><p>What interest me most is cell interaction analysis.</p><p>For a spot, an L–R network score is defined as the sum of expression products between all L–R pairs, divided by the average random value from 1000 randomized networks. P values were calculated with the empirical null distribution generated from network scores of randomized L–Rinteractions.</p><p>Network Score $(\mathrm{NS})=\frac{\sum<em>i E</em>{L i} \times E<em>{R i}}{\left\langle\sum_i E</em>{L i} \times E<em>{R i}\right\rangle}, P$ value $=P_r\left(\mathrm{NS}</em>{\text {random }} \geq \mathrm{NS}\right)$</p><p>$E<em>{Li}$ and $E</em>{Ri}$ donate the expression of ligand and receptor from the ith L–R pair, respectively. The $&lt;&gt;$ represents averaging the product sums from 1000 random networks.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>[1] <a href="https://www.nature.com/articles/s41467-023-36062-6#Sec11">Estimation of cell lineages in tumors from spatial transcriptomics data</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;SpaCET is a toolbox mainly focused on cancer areas in spatial transcriptomics. &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/yiranz</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
    <category term="cancer" scheme="http://example.com/tags/cancer/"/>
    
  </entry>
  
  <entry>
    <title>PDAC</title>
    <link href="http://example.com/2023/02/15/PDAC/"/>
    <id>http://example.com/2023/02/15/PDAC/</id>
    <published>2023-02-15T00:47:35.000Z</published>
    <updated>2023-03-09T12:12:53.803Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I read a new paper about <a href="https://www.nature.com/articles/s41467-023-36296-4?utm_source=pocket_saves">pancreatic ductal adenocarcinoma</a> (PDAC), published in <em>nature communication</em>.</p><p>It mainly studies human PDAC and applies scRNA sequencing on freshly collected human PDAC samples before or after chemotherapy. The abstract has three main results: 1) They find a heterogeneous mixture of basal and classical cancer cell subtypes, along with distinct cancer-associated fibroblast and macrophage subpopulations. 2) Classical and basal-like cancer cells exhibit similar transcriptional responses to chemotherapy and do not demonstrate a shift towards a basal-like transcriptional program among treated samples. 3) Ligand-receptors decrease interactions in treated samples, particularly between TIGIT on CD8 + T cells and its receptor on cancer cells, and identify TIGIT as the significant inhibitory checkpoint molecule of CD8 + T cells. </p><p>Let us see how they analyze the three results.</p><p>One、How to judge the cut-off between basal and classical cancer cell subtypes?</p><p>Here, the researchers found there is no difference between upon conditions. </p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/PDAC_1.png" alt=""></p><p>All samples but one were comprised of a mixture of basal and classical cancer cells in varying proportions. </p><blockquote><p>Although we did not observe this specific intermediate state gene signature (the number of samples in each dataset may limit the generalizability of such a signature), we did discover cancer cells in numerous patient samples that expressed both basal and classical histological markers to varying degrees.</p></blockquote><p>Two 、How to detect Classical and basal-like cancer cells exhibiting similar transcriptional responses?</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/PDAC_3.png" alt=""></p><p>Through gene sets score, they found two groups’ cells are mostly overlapped. </p><p>Three、How to ensure ligand-receptors decreased interactions in treated samples?</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/PDAC_2.png" alt=""></p><p>They employed CellPhoneDB to infer potential ligand-receptor interactions (LRIs) between malignant epithelial cells, TAM and CAF subpopulations, CD8 +and CD4 + T cells, MDSCs, and DCs in naïve and treated samples and found a general decrease of cell-cell interactions in the chemotherapy-treated group by fold change value.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I read a new paper about &lt;a href=&quot;https://www.nature.com/articles/s41467-023-36296-4?utm_source=pocket_saves&quot;&gt;pancreatic ductal</summary>
      
    
    
    
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="tumor" scheme="http://example.com/tags/tumor/"/>
    
  </entry>
  
  <entry>
    <title>CESC and CC</title>
    <link href="http://example.com/2023/02/01/CESC%20and%20CC/"/>
    <id>http://example.com/2023/02/01/CESC%20and%20CC/</id>
    <published>2023-02-01T00:47:35.000Z</published>
    <updated>2023-03-09T12:13:50.469Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I have read two papers from one team and published in <em>Science Advance</em> and <em>Signal Transduction and Targeted Therapy</em>. one is named <em>Single-cell RNA-sequencing reveals radio chemotherapy-induced innate immune activation and MHC-II upregulation in cervical cancer. The other is called </em>Single-cell dissection of cellular and molecular features underlying human cervical squamous cell carcinoma initiation and progression*. As we can see, these two papers study cervical squamous cell carcinoma (CESC) and cervical cancer (CC), both of which are based on single-cell sequencing technology.</p><p>From research ideas, they are similar, and both apply comparison to different conditions. For CESC, they sampled 13 human cervical tissues at various stages of malignancy. For CC, they tested pre-RCT and post-RCT tumor biopsies from patients with cervical cancer and adjacent normal cervical tissues. I think this is an excellent performance of measurement of variables on the experiment design.</p><p>On the analysis methods, they focus on the comparison between pre-condition and post-condition, such as, to test the percentage of epithelia. Most importantly, these two papers’ logic is constant or not diverged, which is what I have learned.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I have read two papers from one team and published in &lt;em&gt;Science Advance&lt;/em&gt; and &lt;em&gt;Signal Transduction and Targeted Therapy</summary>
      
    
    
    
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="tumor" scheme="http://example.com/tags/tumor/"/>
    
  </entry>
  
  <entry>
    <title>iSpatial</title>
    <link href="http://example.com/2022/11/01/iSpatial/"/>
    <id>http://example.com/2022/11/01/iSpatial/</id>
    <published>2022-11-01T13:44:35.000Z</published>
    <updated>2023-03-09T11:55:05.851Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I read a paper named <em>Accurate inference of genome-wide spatial expression with iSpatial</em>, from which I learned a lot.</p><p>iSpatial is used to infer expression patterns of all genes at high spatial resolution by integrating scRNA-seq and ST data. In the process of single-cell RNA sequencing, it can capture more genes as possible it can. In this paper, the authors try to recover all genes’ spatial information of the spatial transcriptomics data based on scRNA. </p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Accurate%20inference%20of%20genome-wide%20spatial%20expression%20with%20iSpatial%20Figure1.png" alt=""></p><p>How do they infer spatial information?</p><p>In the first step, it needs to integrate scRNA and spatial transcriptomics datasets. The core function is a weighted KNN graph. For each cell t in spatial transcriptome data, iSpatial searches the KNNs (<em>KNNt,k</em>).</p><p>Each gene’s expression of cell t was calculated by the following formula:</p><p>$K N N<em>{t, k}:\left{K N N</em>{t, 1}, K N N<em>{t, 2}, \ldots, K N N</em>{t, k}\right}$</p><p>β is an argument to balance the expression from the spatial transcriptome and scRNA-seq. ω is the weight factor that shows the distance between cell t and other KNN neighbor cells. Through the below formula, we can see the most similar neighbor cell, its weight factor is smaller.</p><p>$\widehat{E<em>t}=(1-\beta) E_t+\beta\left(\sum_k \omega</em>{t, k} E<em>{\mathrm{KNN}</em>{t, k}^{\prime}}\right)$</p><p>$\operatorname{dist}\left(E<em>t, E</em>{\mathrm{KNN}<em>{t, k}^t}\right)=1-\operatorname{cor}\left(E_t, E</em>{\mathrm{KNN}_{t, k}^{\prime}}\right)$</p><p>$d<em>{t, k}=\operatorname{dist}\left(E_t, E</em>{\mathrm{KNN}_{t, k}}\right)$</p><p>$\omega<em>{t, k}=\frac{d</em>{t, k}^2}{\sum<em>k d</em>{t, k}^2}$</p><p>But I think this method requires high quality of fitness between scRNA and spatial transcriptomics datasets. </p><p>And, the paper has developed a way to identify spatial variable genes(SVGs). First, it divides the two-dimensional space into n x n grids and calculates the gene mean expression level. Second, it randomly samples the spatial location and calculates the mean gene expression level once more. Finally, to compare whether there have significant differences between the two values.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I read a paper named &lt;em&gt;Accurate inference of genome-wide spatial expression with iSpatial&lt;/em&gt;, from which I learned a lot.&lt;/</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>hdWGCNA</title>
    <link href="http://example.com/2022/09/22/hdWGCNA/"/>
    <id>http://example.com/2022/09/22/hdWGCNA/</id>
    <published>2022-09-22T09:40:25.000Z</published>
    <updated>2023-03-30T15:28:12.545Z</updated>
    
    <content type="html"><![CDATA[<p>How to deduce gene coexpression network is worth thinking.</p><p>I read the paper named “High dimensional co-expression networks enable discovery of transcriptomic drivers in complex biological systems” which focus on gene co-expression networks.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/hdWGCNA_1.png" alt=""></p><p>the signed correlation：</p><p>$a_{i, j}=\frac{1+\operatorname{cor}\left(x_i, x_j\right)}{2}$</p><p>In order to emphasize strong correlations, we raise the elements of A to a power β, and we refer to this as soft power thresholding.</p><p>$\begin{array}{r}\alpha<em>{i, j}=\left(a</em>{i, j}\right)^\beta \ \tilde{\alpha}<em>{i, j}=\alpha</em>{i, j} \times \operatorname{sign}\left(\operatorname{cor}\left(x_i, x_j\right)\right)\end{array}$</p><p>Now we have the gene-gene correlation raised to a power β, and an alternative metric  ̃ αi,j which also retains the sign of the correlation between these genes. The final co-expression network is then computed as a signed topological overlap matrix (TOM). The TOM describes shared neighbors between the a pair of genes (i, j). We define the signed TOM as</p><p>$\operatorname{TOM}<em>{i, j}^{\text {signed }}=\frac{\left|\alpha</em>{i, j}+\sum<em>{u \neq i, j} \tilde{\alpha}</em>{i, u} \tilde{\alpha}<em>{u, j}\right|}{\min \left(k_i, k_j\right)+1-\left|\alpha</em>{i, j}\right|}$</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li><p>[1] <a href="https://www.biorxiv.org/content/10.1101/2022.09.22.509094v1">hdWGCNA</a></p></li><li><p>[2] <a href="http://rstudio-pubs-static.s3.amazonaws.com/554864_6e0f44cdc1474b8ba2c5f8326559bbe4.html">基因共表达网络 WGCNA</a></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;How to deduce gene coexpression network is worth thinking.&lt;/p&gt;
&lt;p&gt;I read the paper named “High dimensional co-expression networks enable </summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
    <category term="co-expression" scheme="http://example.com/tags/co-expression/"/>
    
  </entry>
  
  <entry>
    <title>Anndata</title>
    <link href="http://example.com/2022/08/24/Anndata/"/>
    <id>http://example.com/2022/08/24/Anndata/</id>
    <published>2022-08-24T04:44:35.000Z</published>
    <updated>2023-03-09T12:18:04.153Z</updated>
    
    <content type="html"><![CDATA[<p>Anndata is a Python package for handling annotated data matrices in memory and on disk (<a href="http://github.com/theislab/anndata">github.com/theislab/anndata</a>), positioned between pandas and xarray.</p><h1 id="Anndata-object"><a href="#Anndata-object" class="headerlink" title="Anndata object"></a>Anndata object</h1><p>What’s its structure?</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/anndata_structure.svg" alt=""></p><p>The AnnData object is a collection of arrays aligned to the common dimensions of observations (obs) and variables (var). </p><p>As we can see, color is used to denote elements of the object, with “orange” colors selected for elements aligned to the observations and “blue” colors for elements aligned to variables. The object is centered around the main data matrix X, whose two dimensions correspond to observations and variables respectively. Primary labels for each of these dimensions are stored as obs_names and var_names. If needed, layers stores matrices of the exact same shape as X. One-dimensional annotations for each dimension are stored in pandas DataFrames obs and var. Multi-dimensional annotations are stored in obsm and varm. Pairwise relationships are stored in obsp and varp. Unstructured data which doesn’t fit this model, but should stay associated to the dataset are stored in</p><h1 id="How-to-transfer-a-dataframe-to-anndata-object"><a href="#How-to-transfer-a-dataframe-to-anndata-object" class="headerlink" title="How to transfer a dataframe to anndata object"></a>How to transfer a dataframe to anndata object</h1><p>Let’s see an example.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/dataframe_example.png" alt=""></p><p>This is a gene expression matrix, and I want to transfer it to an anndata object for analysis.</p><p>The first step is to read the dataframe file.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&quot;./Rep11_MOB_count_matrix-1.tsv&quot;</span>,sep=<span class="string">&quot;\t&quot;</span>,index_col=<span class="number">0</span>)</span><br><span class="line">df = df.T</span><br></pre></td></tr></table></figure><p>In an anndata object, obs and var are data frames. So, in the second step, we try to construct this elements.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">obs = pd.DataFrame()</span><br><span class="line">obs[<span class="string">&#x27;sample&#x27;</span>] = df.columns</span><br><span class="line">obs.index = <span class="string">&quot;mob_&quot;</span>+df.columns</span><br><span class="line">var_names = df.index</span><br><span class="line">var = pd.DataFrame(index=var_names)</span><br><span class="line">var[<span class="string">&quot;gene_ids&quot;</span>] = var.index</span><br><span class="line">X = df.T.values</span><br><span class="line">adata = anndata.AnnData(X, obs=obs, var=var,dtype=<span class="string">&#x27;int32&#x27;</span>)</span><br><span class="line">adata.var_names_make_unique() </span><br><span class="line">adata</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spa = pd.DataFrame(index=df.columns)</span><br><span class="line">spa[[<span class="string">&quot;x&quot;</span>,<span class="string">&quot;y&quot;</span>]] = spa.index.to_series().<span class="built_in">str</span>.split(<span class="string">&#x27;x&#x27;</span>, expand=<span class="literal">True</span>)</span><br><span class="line">adata.obsm[<span class="string">&quot;spatial&quot;</span>] = spa.to_numpy()</span><br><span class="line">adata</span><br></pre></td></tr></table></figure><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>[1] <a href="https://www.biorxiv.org/content/10.1101/2021.12.16.473007v1.full">anndata: Annotated data</a></li><li>[2] <a href="https://anndata.readthedocs.io/en/latest/tutorials/notebooks/getting-started.html">Getting started with anndata</a></li><li>[3] <a href="https://chanzuckerberg.github.io/scRNA-python-workshop/preprocessing/00-tabula-muris.html?utm_source=pocket_saves#Building-an-AnnData-object">Building an AnnData object</a></li><li>[4] <a href="https://www.biostars.org/p/9482750/">Pandas dataframe to H5ad file</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Anndata is a Python package for handling annotated data matrices in memory and on disk (&lt;a href=&quot;http://github.com/theislab/anndata&quot;&gt;gith</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="python" scheme="http://example.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>Gitto</title>
    <link href="http://example.com/2022/07/21/Giotto/"/>
    <id>http://example.com/2022/07/21/Giotto/</id>
    <published>2022-07-21T00:47:35.000Z</published>
    <updated>2023-03-09T12:18:18.498Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I read a toolbox <em>Giotto</em> to characterize spatial transcriptomics data. It focus on three parts: 1) characterizing tissue composition; 2) spatial expression patterns; 3) cellular interactions.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/Giotto_Fig.%201.webp" alt=""></p><p>In this literature, what interests me lost is these three aspects.</p><h1 id="1、coherent-gene-expression"><a href="#1、coherent-gene-expression" class="headerlink" title="1、coherent gene expression"></a>1、coherent gene expression</h1><p>In Giotto, it depends on two functions <em>detectSpatialCorGenes and clusterSpatialCorGenes.</em> The first function spatially smooths gene expression through a grid averaging or k-nearest neighbor approach and then calculates the gene-to-gene correlation (default = Pearson) scores. The second function performs hierarchical clustering to cluster the gene-to-gene co-expression network into modules and creates metagene scores by averaging all the genes for each identified co-expression module</p><p>For my perspective, I don’t approve the genes found by this method are belong to gene co-expression relationship. I think they just have gene expression correlation. </p><h1 id="2、spatial-domain-detection"><a href="#2、spatial-domain-detection" class="headerlink" title="2、spatial domain detection"></a>2、spatial domain detection</h1><p>Firstly, HMRF infers the state of each cell as the joint probability of the cell’s intrinsic state (inferred from the cell’s own gene expression vector), and the cell’s extrinsic state, which is based on the distribution of the states of the cell’s neighbors.</p><p>The neighborhood graph defines the extent of the neighbor cell influence, together with the parameter beta that defines the strength of the interaction of cells. </p><p>At the end, HMRF assigns each cell to one of k spatial domains (k to be defined by the user).</p><h1 id="3、spatial-variable-genes"><a href="#3、spatial-variable-genes" class="headerlink" title="3、spatial variable genes"></a>3、spatial variable genes</h1><p>For SVGs, the toolbox integrate methods such like SpatialDE, SPARK, Trendsceek and BinSpect. </p><h1 id="4、cell-cell-communication"><a href="#4、cell-cell-communication" class="headerlink" title="4、cell-cell communication"></a>4、cell-cell communication</h1><p>This is implemented in the function <em>spatCellCellcom.</em> </p><p>$\overline{S(L, R, A, B)}=\frac{1}{n} \sum<em>{i=1}^n L_i+\frac{1}{m} \sum</em>{j=1}^m R_j$</p><p>where $n$ represents the number of A-type cells that interact with B-type cells, $m$ represents the number of B-type cells that interact with A-type cells, $L<em>{i}$ represents the expression level of the ligand in the ith A-type cell, and $R</em>{j}$ represents the expression level of the receptor in the jth B-type cell.</p><p>And how to do the statistic test?</p><p>This background distribution is created by shuffling cell locations within the same cell type for A and B for 1000 (= default) times. In each round, a permutation score Sp is calculated using the same formula. Associated p values were calculated as the probability of Sp to be greater or smaller than the actual observed score S.Thep values for all ligand-receptor pairs in all cell-type pairs were subsequently adjusted for multiple hypothesis testing.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>[1] <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-021-02286-2">Giotto</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I read a toolbox &lt;em&gt;Giotto&lt;/em&gt; to characterize spatial transcriptomics data. It focus on three parts: 1) characterizing tissu</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>scGCO</title>
    <link href="http://example.com/2022/06/10/ScGCO/"/>
    <id>http://example.com/2022/06/10/ScGCO/</id>
    <published>2022-06-10T00:47:35.000Z</published>
    <updated>2023-03-30T03:17:32.576Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I read a fantastic literature about finding SVGs through HMMF and graph cuts algorithm named <em>Identification of spatially variable genes with graph cuts</em>.</p><h1 id="Part1"><a href="#Part1" class="headerlink" title="Part1"></a>Part1</h1><p>Firstly, we must figure out why finding SVGs is critical in spatial transcriptomics?</p><p>Firstly, SVGs are defined as genes whose expression distributions display significant dependence on their spatial locations.</p><h1 id="Part1-1"><a href="#Part1-1" class="headerlink" title="Part1"></a>Part1</h1><p>In this paper, it mentions three reasons:</p><p>1、SVGs could demonstrate strong conservation in their spatial patterns, such that many SV genes display similar dependencies on spatial locations, resulting in similar trends in spatial patterns of their expression values.</p><p>2、SVGs are often markers or essential regulators for tissue pattern formation and homeostasis.</p><p>3、Although these methods demonstrated usefulness in identifying SV genes, they cannot illustrate the exact boundaries of regions demonstrating spatial dependence, which are often of biological interest, and more importantly, these algorithms have computational efficiency of O(n2)orworseandareunsuitable for analyzing large spatial transcriptomics datasets.</p><h1 id="Part2"><a href="#Part2" class="headerlink" title="Part2"></a>Part2</h1><p>How does this paper identify SVGs？</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/ScGCO_Fig.%201.webp" alt=""></p><p>As the above picture illustrated, firstly, to model the spatial gene expression data with HMRF, scGCO first employs Delaunay triangulation to transform spatial locations of measured cells/spots into an undirected graph, where each node represents a data point (a single cell or a spot measuring multiple cells, depending on the technologies utilized) in the spatial transcriptomics data.</p><p>Secondly, scGCO utilizes Gaussian mixture modeling to separate a gene’s expression values into different bins, which represent different gene expression states. The float gene expression value associated with each node in the HMRF was then transformed into the corresponding bin number, and the resulting bin number was assigned to the node, creating an initial label assignment for the HMRF. </p><p>Thirdly, The initialized HMRF was then optimized by the fast graph cuts algorithm of Boykov to learn the true hidden labels of the nodes in HMRF, which represent authentic gene expression states.</p><p>Fourthly, the p-value for each gene was evaluated using the best segmentation under the complete spatial randomness (CSR) framework. Benjamini–Hochberg (BH) correction was utilized to identify spatially variable (SV) genes at the genome-scale.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>[1] <a href="https://www.nature.com/articles/s41467-022-33182-3">Identification of spatially variable genes with graph cuts</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I read a fantastic literature about finding SVGs through HMMF and graph cuts algorithm named &lt;em&gt;Identification of spatially va</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>What is cancer metabolism?</title>
    <link href="http://example.com/2022/05/02/GSVA/"/>
    <id>http://example.com/2022/05/02/GSVA/</id>
    <published>2022-05-02T07:47:35.000Z</published>
    <updated>2023-03-09T12:19:06.027Z</updated>
    
    <content type="html"><![CDATA[<p>Gene Set Variation Analysis is a method to calculate genesets pathway scores across different samples. </p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/GSVA_1.jpg" alt=""></p><p>Firstly, there has an input gene expression matrix. We perform non-parametric kernel estimation of a specific gene’s cumulative density function.</p><p>In the case of microarray data, a Gaussian kernel is used:</p><p>$\widehat{F}<em>{h_i}\left(x</em>{i j}\right)=\frac{1}{n} \sum<em>{k=1}^n \int</em>{-\infty}^{\frac{x<em>{i j}-x</em>{i k}}{h_i}} \frac{1}{\sqrt{2 \Pi}} e^{-\frac{t^2}{2}} d t$</p><p>In the case of RNA-seq data, a discrete Poisson kernel is employed:</p><p>$\widehat{F}<em>r\left(x</em>{i j}\right)=\frac{1}{n} \sum<em>{k=1}^n \sum</em>{y=0}^{x<em>{i j}} \frac{e^{-\left(x</em>{i k}+r\right)}\left(x_{i k}+r\right)^y}{y !}$,</p><p>The cumulative density function is estimated for every gene using all samples from the above distributions. In simpler terms, a CDF value is assigned to each gene in each sample.</p><p>With the CDF of all genes in each sample, we sort them from largest to smallest.</p><p>Secondly, we normalize the rank values. $r_i$ is the rank value of the gene $i$ in sample $S$, $p$ is the gene number. </p><p> $z_{i j}=\left|\frac{p}{2}-r_i\right|$</p><p>Thirdly, to calculate $ES(s)$ with sort  $z_{i j}$</p><p>$\nu<em>{j k}(\ell)=\frac{\sum</em>{i=1}^{\ell}\left|r<em>{i j}\right|^\tau I\left(g</em>{(i)} \in \gamma<em>k\right)}{\sum</em>{i=1}^p\left|r<em>{i j}\right|^\tau I\left(g</em>{(i)} \in \gamma<em>k\right)}-\frac{\sum</em>{i=1}^{\ell} I\left(g_{(i)} \notin \gamma_k\right)}{p-\left|\gamma_k\right|}$,</p><p>$E S<em>{j k}^{\text {diff }}=\left|E S</em>{j k}^{+}\right|-\left|E S<em>{j k}^{-}\right|=\max </em>{\ell=1, \ldots, p}\left(0, v<em>{j k}(\ell)\right)-\min </em>{\ell=1, \ldots, p}\left(0, v_{j k}(\ell)\right)$,</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/GSVA-2.webp" alt=""></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>[1] <a href="https://towardsdatascience.com/decoding-gene-set-variation-analysis-8193a0cfda3">Decoding Gene Set Variation Analysis</a></li><li>[2] <a href="https://www.jianshu.com/p/47f9f0107ffe">GSA、GSEA、ssGSEA、GSVA的算法原理及它们的联系与区别</a></li><li>[3] <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3618321/">GSVA: gene set variation analysis for microarray and RNA-Seq data</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Gene Set Variation Analysis is a method to calculate genesets pathway scores across different samples. &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.gith</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
  </entry>
  
  <entry>
    <title>SOMDE</title>
    <link href="http://example.com/2022/04/20/SOMDE/"/>
    <id>http://example.com/2022/04/20/SOMDE/</id>
    <published>2022-04-20T02:23:35.000Z</published>
    <updated>2023-03-18T13:40:08.312Z</updated>
    
    <content type="html"><![CDATA[<p>Recently, I read a paper to identify spatial variable genes named “<em>SOMDE: a scalable method for identifying spatially variable genes with self-organizing map</em>.”</p><h1 id="Part1"><a href="#Part1" class="headerlink" title="Part1"></a>Part1</h1><p>As its abstract shows:</p><blockquote><p>We present SOMDE, an efficient method for identifying SVgenes in large-scale spatial expression data. SOMDE uses the self-organizing map to cluster neighboring cells into nodes and then uses a Gaussian process to fit the node-level spatial gene expression to identify SVgenes.  Experiments show that SOMDE is about 5–50 times faster than existing methods with comparable results. The adjustable resolution of SOMDE  makes it the only way to give results in  5 min in large datasets of more than 20 000 sequencing sites. SOMDE is available as a  python package on PyPI at <a href="https://pypi.org/project/somde">https://pypi.org/project/somde</a> for educational use.</p></blockquote><p>So, what is the self-organizing map?</p><p>A self-organizing map (SOM) is a type of <a href="https://en.wikipedia.org/wiki/Artificial_neural_network">artificial neural network</a> (ANN) that is trained using unsupervised learning to produce a low-dimensional (typically two-dimensional), discretized representation of the input space of the training samples, called a map, and is therefore, a method to make dimensionality reduction. Self-organizing maps differ from other artificial neural networks as they apply competitive learning instead of error-correction education (such as backpropagation with gradient descent) because they use a neighborhood function to preserve the topological properties of the input space.</p><h1 id="Part2"><a href="#Part2" class="headerlink" title="Part2"></a>Part2</h1><p>And, how does it work in the paper?</p><p>Let us see this figure.</p><p>$N^2 \times k=C$</p><p>where C is a constant representing the total number of data sites, and k is the model parameter called the neighbor number, which denotes the expected average number of original data sites each SOM node represents. This parameter controls how condensed the learned SOM is. A larger k means higher condensation.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/somde.jpeg.jpg" alt=""></p><p>As it showed in (a), it initializes the value and dimension of SOM Node weight $M=(m<em>1,m_2,m</em>{N*N})$ , like the orange spots. After initialization, SOM adjusts the weight of each node toward the tissue spatial topology through a repetitive training process using all spatial coordinates $X=(X_1,X_2,X_3,X_C)$ as tranining samples. </p><p>Cycle after cycle. After training, each data site maps to a unique SOM node. Each SOM node represents the group of sites that are mapped to it. Node weights in the learned SOM can be treated as new spatial coordinates for the data sites. The new spatial locations $X=\left(\tilde{x}<em>1, \tilde{x}_2, \ldots, \tilde{x}</em>{N \times N}\right)$ compose the sparse topology of the original data</p><p>In a SOM node, to define its gene expression as the linear combination of the max value and average value of the gene expression in the group of sites that the node represents. The reason for not using average value as a meta-expression is due to the high sparsity in large-scale data that could bias the result.</p><p>$\tilde{\boldsymbol{Y}}<em>{i, j}=\gamma \cdot \max \left(y</em>{S 1}, y<em>{S 2}, \ldots\right)+(1-\gamma) \cdot \operatorname{avg}\left(y</em>{S 1}, y_{S 2}, \ldots\right)$</p><p>where $y<em>{S 1}$ is the expression value of the gene at the data site $x</em>{S 1}$. The combination ratio $\gamma$ balances the local maximum and mean gene expression. We use  $\gamma = 0.5$  as the default in current experiments.</p><p>With this computational model, how to deduce SVGs?</p><p>$p\left(\tilde{\boldsymbol{y}} \mid H<em>{\mathrm{G}}, \tilde{\boldsymbol{X}}, \Theta\right)=\mathcal{N}\left(\tilde{\boldsymbol{y}} \mid \mu \cdot 1, \sigma_s^2 \cdot \boldsymbol{\Sigma}</em>{k(\tilde{\boldsymbol{x}}, \widetilde{\boldsymbol{x}} \mid \theta)}+\delta \cdot \boldsymbol{I}\right)$</p><p>where $\tilde{\boldsymbol{y}}$  denotes one gene meta-expression in the SOM plane and $\tilde{\boldsymbol{X}}$ denotes SOM node locations. </p><p>$\delta \cdot \boldsymbol{I}$ indicates the non-spatial variance given by Gaussian distributed noise in all observed gene meta-expressions. $\boldsymbol{\Sigma}_{k(\tilde{\boldsymbol{x}}, \widetilde{\boldsymbol{x}} \mid \theta)}$ captures the spatial variation by using a selected kernel function $k(\cdot)$</p><p>Compared with the original Gaussian process model, model HG assumes one gene meta-expression at all spatial locations has the same mean value l so that the non-spatial variance cannot be regressed out. Thus the maximum likelihood value of HG mainly depends on spatial variance.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>[1] <a href="https://medium.com/@abhinavr8/self-organizing-maps-ff5853a118d4">Self Organizing Maps</a></li><li>[2] <a href="https://academic.oup.com/bioinformatics/article/37/23/4392/6308937">SOMDE: a scalable method for identifying spatially variable genes with self-organizing map</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Recently, I read a paper to identify spatial variable genes named “&lt;em&gt;SOMDE: a scalable method for identifying spatially variable genes </summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>Hotspot</title>
    <link href="http://example.com/2022/03/01/Hotspot/"/>
    <id>http://example.com/2022/03/01/Hotspot/</id>
    <published>2022-03-01T08:47:35.000Z</published>
    <updated>2023-03-09T12:18:57.402Z</updated>
    
    <content type="html"><![CDATA[<p>Hotspot is a useful tools to find gene expression module, especially in tumor spatial transcriptome. </p><p>Now, I want to introduce its work principle.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/hotspot_1.jpg" alt=""></p><p>To compute gene modules, Hotspot uses a three-step procedure: </p><p>1、Find informative genes with high local autocorrelation </p><p>Firstly, to compute cells similarity map through KNN graph or spatial position or development lineage. </p><p>For an interested gene $x$, to calculate its $H_x$. </p><script type="math/tex; mode=display">H_x=\sum_j \sum_{j \neq i} w_{i j} x_i x_j</script><p>If cell $i$ and cell $j$ are nearest neighbors, then weight $w<em>{ij}$ is higher then dissimilar cells. If cell $i$ and cell $j$ are denifitely different, then weight $w</em>{ij}$ is equal to 0.</p><p>$x_i$ and $x_j$ are gene $x$ expression value in cell $i$ and cell $j$ . Notably, whether $x_i$ or $x_j$ is standardized expression value (such that <script type="math/tex">E\left[x_i\right]=0</script>，$$<br>E\left[x_i^2\right]=1</p><script type="math/tex; mode=display">).But, how to evaluate $H_x$ and detect informative genes?For each gene, to define a null model in which the expression values are drawn independently from some assumed distribution and transfer $H_x$ to *Z-score*  to eveluate statistically significant.</script><p>\hat{Z}=\frac{\widehat{H}-\mathrm{E}[\hat{H}]}{\operatorname{var}(\widehat{H})^{\frac{1}{2}}}=\frac{\sum<em>i \sum_j w</em>{i j} \widehat{X<em>i} \widehat{X}_j}{\left(\sum_i \sum_j w</em>{i j}^2\right)^{\frac{1}{2}}}</p><script type="math/tex; mode=display">Through this formula, the method measures cell’s expression by its local neighborhood in the graph. Finally, $\hat{Z}$ represents gene expression value. 2、Evaluate pair-wise local correlations between genes In the first step, we can identify informative genes.</script><p>H<em>{x y}=\sum_i \sum</em>{j \neq i} w_{i j}\left(x_i y_j+y_i x_j\right)</p><script type="math/tex; mode=display">Here, the $i$, $j$ indices represent individual cells and $x_i$ and $y_i$ are the standardized expression values in cell $i$ for genes $x$ and $y$, respectively. Weights $w_{ij}$ are defined as before based on the cell similarity map. As with $H_{x}$, the null model is again used to convert $H_{xy}$ values into $Z$ scores.</script><p>\mathrm{E}\left[H<em>{x y}^2\right]=\sum_i^N\left(\sum</em>{j \in N(i)} w_{i j} \hat{x}_j\right)^2</p><p>$$</p><p>3、Cluster the resulting gene-gene affinity matrix</p><p>Through applying a bottom-up clustering procedure with two parameters <em>min_cluster_genes</em>, and <em>fdr_threshold</em> to cluster these genes into module.  </p><p>If a module accumulates more than <em>min_cluster_genes</em>, then it is assigned a label.</p><p>The <em>fdr_threshold</em> parameter is used to set a minimum significant <em>Z-score</em>. If at any point in the above merging module procedure the maximal Z-score falls below this threshold, the procedure halts as further gene assignments fall below the significance threshold and are therefore ambiguous.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h1><ul><li>[1] <a href="https://www.cell.com/cell-systems/fulltext/S2405-4712(21">Hotspot identifies informative gene modules across modalities of single-cell genomics</a>00114-9)</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Hotspot is a useful tools to find gene expression module, especially in tumor spatial transcriptome. &lt;/p&gt;
&lt;p&gt;Now, I want to introduce its</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>SCENIC</title>
    <link href="http://example.com/2022/02/15/SCENIC/"/>
    <id>http://example.com/2022/02/15/SCENIC/</id>
    <published>2022-02-15T10:47:35.000Z</published>
    <updated>2023-03-09T12:18:39.063Z</updated>
    
    <content type="html"><![CDATA[<p>SCENIC is a computational method to deduce gene regulatory networks. </p><p>The main progress has three parts.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/scenic_1.webp" alt=""></p><p>Part1. GENIE3</p><p>Through GENIE3 to identify genesets coexpressed with TF genes. </p><p>The method assumes that a specific gene expression depends on the other genes’ expression in the network. </p><p>Denoting by $x<em>k^{j-1}$ the vector containing the expression values in the $k</em>{th}$ the experiment of all genes except gene <em>j</em>:</p><p>$\mathbf{x}_k^{-j}=\left(x_k^1, \ldots, x_k^{j-1}, x_k^{j+1}, \ldots, x_k^p\right)^{\mathrm{T}}$</p><p>Then,</p><p>$x_k^j=f_j\left(\mathbf{x}_k^{-j}\right)+\varepsilon_k, \forall k$ , where $\varepsilon_k$ is a random noise with zero means (conditionally to $\mathbf{x}_k^{-j}$)</p><p>For <em>j</em> = 1 to <em>p</em>: </p><ul><li>Generate the learning sample of input-output pairs for gene <em>j</em>:</li></ul><p>$L S^j=\left{\left(\mathbf{x}_k^{-j}, x_k^j\right), k=1, \ldots, N\right}$</p><ul><li><p>Use a feature selection technique on $L S^j$ to compute confidence levels $w_{i, j}, \forall i \neq j$, for all genes except gene <em>j</em> itself.</p></li><li><p>Aggregate the <em>p</em> individual gene rankings to get a global scale of all regulatory links.</p></li></ul><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/GENIE3.png" alt=""></p><p>Part2. RcisTarget</p><p>RcisTarget identifies enriched TF-binding motifs and candidate transcription factors for a gene list.</p><p>In these two steps: </p><p>Step 1 selects DNA motifs significantly over-represented in the surroundings of the transcription start site (TSS) of the genes in the gene set. </p><p>Step 2, RcisTarget predicts candidate target genes (i.e., genes in the gene set that are ranked above the leading edge), like enrichment analysis.</p><p>Part3. AUCell</p><p>The input of AUCell is a regulon that contains TF and regulated genes. </p><p>AUCell calculates the enrichment of the regulon as an area under the recovery curve (AUC) across the ranking of all genes in a particular cell, whereby genes are ranked by their expression value.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>[1] <a href="https://www.nature.com/articles/nmeth.4463">SCENIC</a></li><li>[2] <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0012776">GENIE3</a></li><li>[3] <a href="https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.1000435">RcisTarget</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;SCENIC is a computational method to deduce gene regulatory networks. &lt;/p&gt;
&lt;p&gt;The main progress has three parts.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="scRNA" scheme="http://example.com/tags/scRNA/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>SpatialDE</title>
    <link href="http://example.com/2022/01/20/SpatialDE/"/>
    <id>http://example.com/2022/01/20/SpatialDE/</id>
    <published>2022-01-20T14:17:09.000Z</published>
    <updated>2023-03-17T12:13:18.444Z</updated>
    
    <content type="html"><![CDATA[<p>To some degree, SpatialDE is the first literature focused on spatial variable genes(SVGS).</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/spatialde_figure1.webp" alt=""></p><p>Now, I would like to intriduce the algorithm principle.</p><p>Its method depend on Gaussian process regression. For each gene, SpatialDE decomposes expression variability into spatial and nonspatial components, using two random effect terms: a spatial variance term that parametrizes gene expression covariance by pairwise distances of samples, and a noise term that models nonspatial variability. </p><p>$P\left(y \mid \mu, \sigma_s^2, \delta, \Sigma\right)=N\left(y \mid \mu \cdot 1, \sigma_s^2 \cdot(\Sigma+\delta \cdot I)\right)$</p><p>$y$ represents the observed gene expression levels, $μ$ represents the mean expression level, $\sigma_s^2$ represents the variance of the expression levels, $δ$ represents the spatial variance, and $Σ$ represents the covariance matrix of the spatial coordinates.</p><p>$\Sigma_{i, j}=k\left(x_i, x_j\right)=\exp \left(-\frac{\left|x_i-x_j\right|^2}{2 \cdot l^2}\right)$</p><p>$x_i$ and $x_j$ represent the spatial coordinates of two locations, and $l$ is a parameter that determines the scale of the distance over which the similarity between the locations is calculated. The function calculates the similarity between the two locations as a value between 0 and 1, with higher values indicating greater similarity.</p><p>The second covariance term  $δ ·I$ accounts for independent nonspatial variation in gene expression, where the ratio $1/(1 + δ)$ can be interpreted as the fraction of expression variance attributable to spatial effects. Model parameters are fit by maximizing the marginal log likelihood (LL)</p><p>$\begin{aligned} L L= &amp; -\frac{1}{2} \cdot N \cdot \log (2 \pi)-\frac{1}{2} \cdot \log \left(\left|\sigma_s^2 \cdot(\Sigma+\delta \cdot I)\right|\right) \ &amp; -\frac{1}{2} \cdot(y-\mu \cdot 1)^T\left(\sigma_s^2 \cdot(\Sigma+\delta \cdot I)\right)^{-1}(y-\mu \cdot 1)\end{aligned}$</p><p>To estimate statistical significance, it compared the model likelihood of the fitted SpatialDE model with the likelihood of a model that corresponds to the null hypothesis of no spatial covariance,</p><p>$P\left(y \mid \mu, \sigma^2\right)=N\left(\mu \cdot 1, \sigma^2 \cdot I\right)$</p><p>Then estimating <em>P</em> values analytically on the basis of the χ2 distribution transformation with one degree of freedom.</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>[1] <a href="https://www.nature.com/articles/nmeth.4636">SpatialDE: identification of spatially variable genes</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;To some degree, SpatialDE is the first literature focused on spatial variable genes(SVGS).&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
  <entry>
    <title>GO enrichment</title>
    <link href="http://example.com/2022/01/01/GO%20enrichment/"/>
    <id>http://example.com/2022/01/01/GO%20enrichment/</id>
    <published>2022-01-01T05:47:35.000Z</published>
    <updated>2023-03-09T12:20:13.300Z</updated>
    
    <content type="html"><![CDATA[<p>GO enrichment analysis is a prevalent method to characterize genesets’ profiles. </p><p>What does it mean?</p><p>GO is the gene ontology, a structured, controlled vocabulary for classifying gene function at the molecular and cellular levels. It is divided into three separate sub-ontologies: biological process (e.g., signal transduction), molecular function (e.g., ATPase activity), and cellular component (e.g., ribosome)<sup><a href="#fn_1" id="reffn_1">1</a></sup>.</p><p>How to calculate GO term scores?</p><p>To Calculate p-values through a hypergeometric distribution test.</p><p>We have a geneset containing <em>n</em> and <em>k</em> genes in one specific GO term. All GO terms have <em>N</em> genes. For one particular GO term, there have K genes.</p><p>The hypergeometric distribution measures precisely the probability of <strong>k</strong> successes in <strong>n</strong> draws, without replacement, from a finite population of size <strong>N</strong> that contains exactly <strong>K</strong> successful objects:</p><p>$\mathrm{P}(\mathrm{X}=k)=\frac{\left(\begin{array}{l}K \ k\end{array}\right)\left(\begin{array}{l}N-n \ K-k\end{array}\right)}{\left(\begin{array}{l}N \ n\end{array}\right)}$</p><p>$\mathrm{p-value}=1-\mathrm{P}(\mathrm{X}=k)$</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>[1] <a href="https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/goenrichment/tutorial.html">https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/goenrichment/tutorial.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;GO enrichment analysis is a prevalent method to characterize genesets’ profiles. &lt;/p&gt;
&lt;p&gt;What does it mean?&lt;/p&gt;
&lt;p&gt;GO is the gene ontolog</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
  </entry>
  
  <entry>
    <title>SPARK</title>
    <link href="http://example.com/2021/03/14/SPARK/"/>
    <id>http://example.com/2021/03/14/SPARK/</id>
    <published>2021-03-14T15:02:21.000Z</published>
    <updated>2023-03-17T13:43:49.933Z</updated>
    
    <content type="html"><![CDATA[<h1 id="What-is-SPARK"><a href="#What-is-SPARK" class="headerlink" title="What is SPARK?"></a>What is SPARK?</h1><p>SPARK directly models spatial count data through generalized linear spatial models. It relies on recently developed statistical formulas for hypothesis testing, effectively controlling type I errors and yielding high statistical power.</p><p>This literature thinks there are three disadvantages in the two existing approaches to identifying spatial variable genes(SVGs).</p><p>Firstly, SpatialDE and Trendsceek transform count data into normalized data, which may fail to account for the mean-variance relationship in raw counts. </p><p>Secondly, SpatialDE relies on asymptotic normality and minimal <em>P</em>-value-combination rules for constructing hypothesis tests which may cause many true SVGs ignored. </p><p>Thirdly, like  Trendsceek, its module is not efficient which causes amounts of calculation time.</p><h1 id="SPARK’s-principle"><a href="#SPARK’s-principle" class="headerlink" title="SPARK’s principle"></a>SPARK’s principle</h1><p>Now, I would like to choose the SPARK principle.</p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/SPARK_1.png" alt=""></p><p>It builds upon a generalized linear spatial model (GLSM) with a variety of spatial kernels to accommodate count data generated from smFISH or sequencing-based spatial transcriptomics studies. With a newly developed penalized quasi-likelihood (PQL) algorithm, SPARK is scalable to analyzing tens of thousands of genes across tens of thousands spatial locations. Importantly, SPARK relies on a mixture of χ2 distributions to serve as the exact test statistics distribution and takes advantage of a recently developed Cauchy combination rule to combine information across multiple spatial kernels for calibrated <em>P</em> value calculation. As a result, SPARK properly controls for type I error at the transcriptome-wide level and is more powerful for identifying SE genes than existing approaches.</p><p>$y_i\left(s_i\right) \sim \operatorname{Poi}\left(N_i\left(s_i\right) \lambda_i\left(s_i\right)\right), i=1,2, \cdots, n$</p><p>$y_i\left(s_i\right)$ as the gene expression measurement in terms of counts for the <em>i</em>’th sample. </p><p>$N_i(s_i)$ as the normalization factor for i’th sample. Here, it set $N_i(s_i)$ as the summation of the total number of counts across all genes for the sample as the main interest is in analyzing the relative gene expression level.</p><p>$\log \left(\lambda_i\left(s_i\right)\right)=\boldsymbol{x}_i\left(s_i\right)^{\boldsymbol{T}} \boldsymbol{\beta}+b_i\left(s_i\right)+\epsilon_i$</p><p>where $\lambda<em>i\left(s_i\right)$ is an unknown Poisson rate parameter that represents the underlying gene expression level for the <em>i’</em>th sample. In the spatial setting, $\lambda_i\left(s_i\right)$  can also be viewed as the unobserved spatial random process occurring at location $𝒔</em>𝑖$. We model the log scale of the latent variable $\lambda_i\left(s_i\right)$ as a linear combination of three terms.</p><p>$\log \left(\lambda_i\left(s_i\right)\right)=\boldsymbol{x}_i\left(s_i\right)^T \boldsymbol{\beta}+b_i\left(s_i\right)+\epsilon_i$</p><p>$x_i\left(s_i\right)$ is <em>k</em>-vector of covariates that include a scalar of one for the intercept and <em>k</em>-1 observed explanatory variables for the i’th sample. </p><p><strong>𝜷</strong> is a <em>k</em>-vector of coefficients that include an intercept representing the mean log-expression of the gene across spatial locations together with <em>k</em>-1 coefficients for the corresponding covariates; ∈𝑖 is the residual error that is independently and identically distributed from 𝑁(0,$𝜏^2$) with variance $𝜏^2$; and $𝑏<em>𝑖(𝒔</em>𝑖)$ is a zero-mean, stationary Gaussian process modeling the spatial correlation pattern among spatial locations</p><p>$\boldsymbol{b}(s)=\left(b_1\left(s_1\right), b_2\left(s_2\right), \cdots, b_n\left(s_n\right)\right)^T \sim \operatorname{MVN}\left(0, \tau_1 \boldsymbol{K}(s)\right)$</p><p>The covariance $K(s)$ is a kernel function of the spatial locations <strong>𝒔</strong>=(<strong>𝒔</strong>1,…,<strong>𝒔</strong>𝑛)𝑇, with <em>ij</em>’th element being 𝑲($𝒔<em>𝑖$,$𝒔</em>𝑗$); 𝜏1 is a scaling factor of the covariance kernel; and MVN denotes a multivariate normal distribution. </p><p>This is the defined GLSM model.</p><p>testing whether a gene shows spatial expression pattern can be translated into testing the null hypothesis $𝑯_0$:𝜏1=0. The statistical power of such a hypothesis test will inevitably depend on how the spatial kernel function $K(s)$ matches the true underlying spatial pattern displayed by the gene of interest.</p><p>The true underlying spatial pattern for any gene is unfortunately unknown and may vary across genes. To ensure robust identification of SE genes across various spatial patterns, SPARK considers using a total of ten different spatial kernels, including five periodic kernels with different periodicity parameters and five Gaussian kernels with different smoothness parameters. </p><p><img src="https://raw.githubusercontent.com/yiranzhimo/Pictures/master/SPARK_2.png" alt=""></p><h1 id="How-to-calculate-the-p-value"><a href="#How-to-calculate-the-p-value" class="headerlink" title="How to calculate the p-value"></a>How to calculate the p-value</h1><p>First, SPARK tests the null hypothesis using the ten kernels one at a time. By one designed algorithm, to get the p-value. Afterward, it combines these ten <em>p</em>-values through the recently developed Cauchy <em>p</em>-value combination rule. To apply the Cauchy combination rule, we convert each of the ten <em>p</em>-values into a Cauchy statistic, aggregate the ten Cauchy statistics through summation, and convert the summation back to a single <em>p</em>-value based on the standard Cauchy distribution, because the Cauchy rule takes advantage of the fact that combination of Cauchy random variables also follows a Cauchy distribution regardless whether these random variables are correlated or not</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul><li>[1] <a href="https://www.nature.com/articles/s41592-019-0701-7">Statistical analysis of spatial expression patterns for spatially resolved transcriptomic studies</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;What-is-SPARK&quot;&gt;&lt;a href=&quot;#What-is-SPARK&quot; class=&quot;headerlink&quot; title=&quot;What is SPARK?&quot;&gt;&lt;/a&gt;What is SPARK?&lt;/h1&gt;&lt;p&gt;SPARK directly models sp</summary>
      
    
    
    
    
    <category term="tools" scheme="http://example.com/tags/tools/"/>
    
    <category term="principle" scheme="http://example.com/tags/principle/"/>
    
    <category term="spatial transcriptomics" scheme="http://example.com/tags/spatial-transcriptomics/"/>
    
  </entry>
  
</feed>
